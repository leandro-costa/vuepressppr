<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Strategy (GOF) | Padr√µes de Projetos</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css">
    <link rel="icon" href="/vuepressppr/logo.png">
    <link rel="manifest" href="/vuepressppr/manifest.json">
    <link rel="apple-touch-icon" href="/vuepressppr/icon-192x192.png">
    <link rel="mask-icon" href="/vuepressppr/icon-192x192.png" color="#3eaf7c">
    <meta name="description" content="Material para as aulas da disciplina de Padr√µes de Projetos">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icon-192x192.png">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/vuepressppr/assets/css/0.styles.db063fab.css" as="style"><link rel="preload" href="/vuepressppr/assets/js/app.bbe71492.js" as="script"><link rel="preload" href="/vuepressppr/assets/js/2.9af12a35.js" as="script"><link rel="preload" href="/vuepressppr/assets/js/17.200cc9cd.js" as="script"><link rel="preload" href="/vuepressppr/assets/js/3.6a601bc8.js" as="script"><link rel="prefetch" href="/vuepressppr/assets/js/10.2686d00a.js"><link rel="prefetch" href="/vuepressppr/assets/js/11.a34fa059.js"><link rel="prefetch" href="/vuepressppr/assets/js/12.4be18eab.js"><link rel="prefetch" href="/vuepressppr/assets/js/13.3b095311.js"><link rel="prefetch" href="/vuepressppr/assets/js/14.77172f79.js"><link rel="prefetch" href="/vuepressppr/assets/js/15.b1579a28.js"><link rel="prefetch" href="/vuepressppr/assets/js/16.451d89bb.js"><link rel="prefetch" href="/vuepressppr/assets/js/18.0bf5be7c.js"><link rel="prefetch" href="/vuepressppr/assets/js/19.ffb546a9.js"><link rel="prefetch" href="/vuepressppr/assets/js/20.b9e0cd9f.js"><link rel="prefetch" href="/vuepressppr/assets/js/21.05fff143.js"><link rel="prefetch" href="/vuepressppr/assets/js/4.7876d50c.js"><link rel="prefetch" href="/vuepressppr/assets/js/5.2b7133b0.js"><link rel="prefetch" href="/vuepressppr/assets/js/6.28e79f91.js"><link rel="prefetch" href="/vuepressppr/assets/js/7.a41c72a8.js"><link rel="prefetch" href="/vuepressppr/assets/js/8.c3a503dd.js"><link rel="prefetch" href="/vuepressppr/assets/js/9.be36a7d7.js">
    <link rel="stylesheet" href="/vuepressppr/assets/css/0.styles.db063fab.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuepressppr/" class="home-link router-link-active"><!----> <span class="site-name">Padr√µes de Projetos</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/leandro-costa/vuepressppr" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/leandro-costa/vuepressppr" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Strategy (GOF)</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vuepressppr/gof/Strategy.html#intencao" class="sidebar-link">Inten√ß√£o</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/Strategy.html#tambem-conhecido-como" class="sidebar-link">Tamb√©m conhecido como</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/Strategy.html#motivacao" class="sidebar-link">Motiva√ß√£o</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/Strategy.html#aplicabilidade" class="sidebar-link">Aplicabilidade</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/Strategy.html#estrutura" class="sidebar-link">Estrutura</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/Strategy.html#participantes" class="sidebar-link">Participantes</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/Strategy.html#colaboracoes" class="sidebar-link">Colabora√ß√µes</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/Strategy.html#consequencias" class="sidebar-link">Consequ√™ncias</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/Strategy.html#implementacao" class="sidebar-link">Implementa√ß√£o</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/Strategy.html#exemplo-de-codigo" class="sidebar-link">Exemplo de c√≥digo</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/Strategy.html#usos-conhecidos" class="sidebar-link">Usos conhecidos</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/Strategy.html#padrao-relacionados" class="sidebar-link">Padr√£o relacionados</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/Strategy.html#referencias" class="sidebar-link">Refer√™ncias</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="strategy-gof"><a href="#strategy-gof" class="header-anchor">#</a> Strategy (GOF)</h1> <p><sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup></p> <h2 id="intencao"><a href="#intencao" class="header-anchor">#</a> Inten√ß√£o</h2> <p>Definir uma fam√≠lia de algoritmos, encapsular cada uma delas e torn√°-las intercambi√°veis. Strategy permite que o algoritmo varie independentemente dos clientes que o utilizam</p> <h2 id="tambem-conhecido-como"><a href="#tambem-conhecido-como" class="header-anchor">#</a> Tamb√©m conhecido como</h2> <p>Policy</p> <h2 id="motivacao"><a href="#motivacao" class="header-anchor">#</a> Motiva√ß√£o</h2> <p>Existem muitos algoritmos para quebrar um stream de texto em linhas. Codificar de maneira fixa e r√≠gida tais algoritmos nas classes que os utilizam n√£o √© desej√°vel, por v√°rias raz√µes:</p> <ul><li>clientes que necessitam de quebras de linhas se tornam mais complexos se incluirem o c√≥digo de quebra de linhas. Isso os torna maiores e mais dif√≠ceis de manter, especialmente se suportam m√∫ltiplos algoritmos de quebra de linhas;</li> <li>diferentes algoritmos ser√£o apropriados em diferentes situa√ß√µes. N√£o queremos suportar m√∫ltiplos algoritmos de quebra de linhas se n√£o usarmos todos eles;</li> <li>√© dif√≠cil adicionar novos algoritmos e variar os existentes quando a quebra de linha √© parte integrante de um cliente.</li></ul> <p>Podemos evitar esses problemas definindo classes que encapsulam diferentes algoritmos de quebra de linhas. Um algoritmo encapsulado dessa maneira √© chamado <strong>strategy</strong> (estrat√©gia).</p> <img src="https://www.plantuml.com/plantuml/svg/XP512i8m44NtSufPwg8UeBYeU0IzG8XJ22IPCXb5gTxTQhID5dJtOTxa_I5DKYDw31wiDodXbaF7oQdZs8EAEP4aMYn1g3DEXd03S559McDff5bwiCzC6IcUGQuAhhPZ18YiX9vQHMvBSrrd7GBYnAyc0yK3FfRXrNhdGkUfR8FuNisDChUdytze8s8klx1fXkjhLStiC-13Evj--Q0PhXi-v0u0" alt="uml diagram"> <p>Suponha que uma classe Composition seja respons√°vel pela manuten√ß√£o e atualiza√ß√£o das quebras de linhas de texto exibidas num visualizador de texto. As estrat√©gias de quebra de linhas n√£o s√£o implementadas pela classe Composition. Em vez disso, s√£o implementadas separadamente por subclasses da classe abstrata Compositor. Subclasses de Compositor implementam diferentes estrat√©gias:</p> <ul><li><strong>SimpleCompositor</strong>:  Implementa uma estrat√©gia simples que determina quebras de linha, uma por vez.</li> <li><strong>TeXCompositor</strong>:  Implementa o algoritmo TEX para encontrar quebras de linhas. Esta estrat√©gia tenta otimizar globalmente as quebras de linhas, ou seja, um par√°grafo por vez.</li> <li><strong>ArrayCompositor</strong>:  Implementa uma estrat√©gia que seleciona quebras de maneira que cada linha tenha um n√∫mero fixo de itens. Por exemplo, √© √∫til para quebrar uma cole√ß√£o de √≠cones em linhas.</li></ul> <p>Uma Composition mant√©m uma refer√™ncia para um objeto Compositor. Sempre que uma Composition reformata seu texto, repassa essa responsabilidade para o seu objeto Compositor. O cliente de Composition especifica qual Compositor deveria ser usado pela instala√ß√£o do Compositor que ele deseja em Composition.</p> <h2 id="aplicabilidade"><a href="#aplicabilidade" class="header-anchor">#</a> Aplicabilidade</h2> <p>Use o padr√£o Strategy quando:</p> <ul><li>muitas classes relacionadas diferem somente no seu comportamento. As estrat√©gias fornecem uma maneira de configurar uma classe com um dentre muitos comportamentos;</li> <li>voc√™ necessita de variantes de um algoritmo. Por exemplo, pode definir algoritmos que refletem diferentes solu√ß√µes de compromisso entre espa√ßo/ tempo. As estrat√©gias podem ser usadas quando essas variantes s√£o implementadas como uma hierarquia de classes de algoritmos [HO871];</li> <li>um algoritmo usa dados dos quais os clientes n√£o deveriam ter conhecimento. Use o padr√£o Strategy para evitar a exposi√ß√£o das estruturas de dados complexas, espec√≠ficas do algoritmo;</li> <li>uma classe define muitos comportamentos, e estes aparecem em suas opera√ß√µes como m√∫ltiplos comandos condicionais da linguagem. Em vez de usar muitos comandos condicionais, mova os ramos condicionais relacionados para a sua pr√≥pria classe Strategy.</li></ul> <h2 id="estrutura"><a href="#estrutura" class="header-anchor">#</a> Estrutura</h2> <img src="https://www.plantuml.com/plantuml/svg/SoWkIImgAStDuKhEIImkLd3Epoj9hIYfvag6C3A1P55QOdAgXYPNBHSNdAiGN5AKM9AQNbdDbPYJdb-KMPAHYwOMQfH2lYvSiLKnbC65i2wvABKa5QR0iPfB0GXm68bTZnCPUfpnwe6fKh2fqTN5T2C1UIS2yivS3gbvAS0W1m00" alt="uml diagram"> <h2 id="participantes"><a href="#participantes" class="header-anchor">#</a> Participantes</h2> <ul><li><strong>Strategy</strong> (Compositor)
<ul><li>define uma interface comum para todos os algoritmos suportados. Context usa esta interface para chamar o algoritmo definido por uma Concrete Strategy</li></ul></li> <li><strong>ConcreteStrategy</strong> (SimpleCompositor, TexCompositor, ArrayCompositor)
<ul><li>implementa o algoritmo usando a interface de Strategy.</li></ul></li> <li><strong>Context</strong> (Composition)
<ul><li>√© configurado com um objeto Concrete Strategy;</li> <li>mant√©m uma refer√™ncia para um objeto Strategy,</li> <li>pode definir uma interface que permite a Strategy acessar seus dados.</li></ul></li></ul> <h2 id="colaboracoes"><a href="#colaboracoes" class="header-anchor">#</a> Colabora√ß√µes</h2> <ul><li>Strategy e Context interagem para implementar o algoritmo escolhido. Um contexto pode passar todos os dados requeridos pelo algoritmo para a estrat√©gia quando o algoritmo √© chamado. Alternativamente, o contexto pode passar a si pr√≥prio como argumento para opera√ß√µes de Strategy. Isto permite √† estrat√©gia chamar de volta o contexto conforme requerido.</li> <li>Um contexto repassa solicita√ß√µes dos seus clientes para sua estrat√©gia. Os clientes usualmente criam e passam um objeto Concrete Strategy para o contexto; ap√≥s isso, interagem exclusivamente com o contexto. Freq√ºentemente existe uma fam√≠lia de classes Concrete Strategy para um cliente fazer sua escolha.</li></ul> <h2 id="consequencias"><a href="#consequencias" class="header-anchor">#</a> Consequ√™ncias</h2> <p>O padr√£o Strategy tem os seguintes benef√≠cios e desvantagens:</p> <ol><li>Fam√≠lias de algoritmos relacionados. Hierarquias de classes Strategy definem uma fam√≠lia de algoritmos e comportamentos para os contextos reutilizarem. A heran√ßa pode ajudar a fatorar a funcionalidade comum dos algoritmos.</li> <li>Uma alternativa ao uso de subclasses. A heran√ßa oferece uma outra maneira de suportar uma variedade de algoritmos ou comportamentos. Voc√™ pode especializar uma classe Context para lhe dar diferentes comportamentos. Mas isso congela o comportamentoem Context, misturando a implementa√ß√£o do algoritmo coma de Context, tornando Context mais dif√≠cil de compreender, manter e estender. E n√£o se pode variar de algoritmo dinamicamente. Voc√™ acaba tendo muitas classes relacionadas cuja √∫nica diferen√ßa √© o algoritmo ou comportamento que elas empregam. Encapsular os algoritmos em classes Strategy separadas permite variar o algoritmo independentemente do seu contexto, tornando mais f√°cil troc√°-los, compreend√™-los e estend√™-los.</li> <li>Estrat√©gias eliminam comandos condicionais da linguagem de programa√ß√£o. O padr√£o Strategy oferece uma alternativa ao uso de comandos condicionais para a sele√ß√£o de comportamentos desejados. Quando diferentes comportamentos s√£o agrupados em uma classe √© dif√≠cil evitar o uso de comandos condicionais para a sele√ß√£o do comportamento correto. O encapsulamento do comportamento em classes Strategy separadas elimina estes comandos condicionais. Por exemplo, sem usar estrat√©gias, o c√≥digo para quebrar o texto em linhas se pareceria com</li></ol> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">void</span> repair <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>breakingStrategy<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token class-name">SimpleStrategy</span><span class="token operator">:</span>
            <span class="token function">composeWithSimpleCompositor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token class-name">TexStrategy</span><span class="token operator">:</span>
            <span class="token function">composeWithTexCompositor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token comment">// junta os resultados com a composi√ß√£o existente, se necess√°rio</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>O padr√£o Strategy elimina este comando case pela delega√ß√£o da tarefa de quebra de linhas para um objeto Strategy:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">void</span> repair <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    compositor<span class="token punctuation">.</span><span class="token function">compose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// junta os resultados com a composi√ß√£o existente, se necess√°rio</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Um c√≥digo que cont√©m muitos estados freq√ºentemente indica a necessidade de aplicar o padr√£o Strategy.</p> <ol start="4"><li>A possibilidade de escolha de implementa√ß√µes. As estrat√©gias podem fornecer diferentes implementa√ß√µes do mesmo comportamento. O cliente pode escolher entre estrat√©gias com diferentes compromissos entre tempo e espa√ßo.</li> <li>Os clientes devem conhecer diferentes Strategies. O padr√£o tem uma defici√™ncia potencial no fato de que um cliente deve compreender como Strategies diferem, antes que ele possa selecionar o mais apropriado. Os clientes podem ser expostos a detalhes e aspectos de implementa√ß√£o. Portanto, voc√™ deveria usar o padr√£o Strategy somente quando a varia√ß√£o em comportamento √© relevante para os clientes.</li> <li>Custo de comunica√ß√£o entre Strategye Context. A interface de Strategy √© compartilhada por todas as classes Concrete Strategy, quer os algoritmos que elas implementem sejam triviais ou complexos. Da√≠ ser prov√°vel que alguns Concrete Strategy n√£ousem toda a informa√ß√£o passada atrav√©s desta interface; Concrete Strategies simples podem n√£o usar quaisquer dessas informa√ß√µes! Isso significa que existir√£o situa√ß√µes em que o contexto criar√° e iniciar√° par√¢metros que nunca ser√£o usados. Se esse forum problema, voc√™ necessitar√° de um acoplamento maior entre Strategy e Context.</li> <li>Aumento do n√∫mero de objetos. Strategies aumentam o n√∫mero de objetos numa aplica√ß√£o. Algumas vezes, voc√™ pode reduzir esse custo pela implementa√ß√£o de estrat√©gias como objetos sem estados que os contextos possam compartilhar. Qualquer estado residual √© mantido pelo contexto, que o passa em cada solicita√ß√£o para o objeto Strategy.</li></ol> <h2 id="implementacao"><a href="#implementacao" class="header-anchor">#</a> Implementa√ß√£o</h2> <p>Considere os seguintes aspectos de implementa√ß√£o:</p> <ol><li>Definindo as interfaces de Strategy e Context. As interfaces de Strategy e Context podem fornecer a uma Concrete Strategy um acesso eficiente a quaisquer dados que necessite de um contexto, e vice-versa. Uma solu√ß√£o √© fazer com que context passe dados atrav√©s de par√¢metros para as opera√ß√µes de Strategy - em outras palavras, levar os dados para a estrat√©gia. Isso mant√©m Strategy e Context desacoplados. Por outro lado, Context pode passar dados de que Strategy n√£o necessita. Uma outra t√©cnica √© fazer um contexto passar a si pr√≥prio como um argumento, e ent√£o a estrat√©gia solicitar dados do contexto explicitamente. Alternativamente, a estrat√©gia pode armazenar uma refer√™ncia para o seu contexto, eliminando de todo a necessidade de passar qualquer coisa. De ambas as maneiras, a estrat√©gia pode solicitar exatamente o que ela necessita. Por√©m, agora, Context deve definir uma interface mais elaborada para os seus dados, o que acopla Strategy e Context mais fortemente. As necessidades de um algoritmo espec√≠fico e seus requisitos de dados determinar√£o qual a melhor t√©cnica.</li> <li>Estrat√©gias como par√¢metros template. Em C++, templates podem ser usados para configurar uma classe com uma estrat√©gia. Esta t√©cnica somente √© aplic√°vel se: (1) Strategy pode ser selecionada em tempo de compila√ß√£o e (2) ela n√£o tem que ser mudada em tempo de execu√ß√£o. Nesse caso, a classe a ser configurada (por exemplo, Context) √© definida como uma classe template que tem como par√¢metro uma classe <em>Strategy:</em></li></ol> <div class="language-objectivec line-numbers-mode"><pre class="language-objectivec"><code>template <span class="token operator">&lt;</span>class AStrategy<span class="token operator">&gt;</span>
class Context
    <span class="token keyword">void</span> <span class="token function">Operation</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> theStrategy<span class="token punctuation">.</span><span class="token function">DoAlgorithm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token comment">// ...</span>
private<span class="token punctuation">:</span>
    Astrategy theStrategy<span class="token punctuation">;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>A classe √© ent√£o configurada com uma classe Strategy quando √© instanciada:</p> <div class="language-objectivec line-numbers-mode"><pre class="language-objectivec"><code>class MyStrategy <span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token keyword">void</span> <span class="token function">DoAlgorithm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
Context<span class="token operator">&lt;</span>MyStrategy<span class="token operator">&gt;</span> acontext<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Com <em>templates,</em> n√£o h√° necessidade de definir uma classe abstrata que defina a interface para Strategy. Usar Strategy como um par√¢metro de template tamb√©m permite vincular uma Strategy ao seu context estaticamente, o que pode melhorar a efici√™ncia.</p> <ol start="3"><li>Tornando os objetos Strategy opcionais. A classe Context pode ser simplificada se fizer sentido n√£o ter um objeto Strategy. Context verifica se ele tem o objeto Strategy antes de acess√°-lo. Se existir um, ent√£o Contexto utiliza normalmente. Se n√£o houver uma estrat√©gia, ent√£o Context executa o comportamento-padr√£o. O benef√≠cio dessa solu√ß√£o √© que os clientes n√£o t√™m que lidar com nenhum objeto Strategya menos que eles n√£o queiram o comportamento padr√£o.</li></ol> <h2 id="exemplo-de-codigo"><a href="#exemplo-de-codigo" class="header-anchor">#</a> Exemplo de c√≥digo</h2> <p>Daremos o c√≥digo de alto n√≠vel para o exemplo da se√ß√£o Motiva√ß√£o, o qual est√° baseado na implementa√ß√£o das classes Composition e Compositor em Inter Views [LCI+92].</p> <p>A classe Composition mant√©m uma cole√ß√£o de Component, a qual representa texto e elementos gr√°ficos num documento. Uma composi√ß√£o arruma os objetos componentes em linhas usando uma inst√¢ncia da subclasse Compositor, a qual encapsula uma estrat√©gia de quebra de linhas. Cada componente tem associados um tamanho natural, uma extensibilidade e uma compressibilidade. A extensibilidade define quanto o componente pode crescer al√©m do seu tamanho natural;compressibilidade √© quanto ele pode ser comprimido. A composi√ß√£o passa esses valores para um compositor, o qual os utiliza para determinar a melhor localiza√ß√£o para quebras de linha.</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Composition</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Compositor</span> compositor<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Component</span><span class="token punctuation">&gt;</span></span> components<span class="token punctuation">;</span><span class="token comment">// a lista de componentes</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> componentCount<span class="token punctuation">;</span> <span class="token comment">// o n√∫mero de componentes</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> lineWidth<span class="token punctuation">;</span> <span class="token comment">// largura da linha</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> lineBreaks<span class="token operator">:</span> <span class="token comment">// posi√ß√£o das quebras das linhas em componentes</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> lineCount<span class="token punctuation">;</span> <span class="token comment">// n√∫mero de linhas</span>

    <span class="token keyword">public</span> <span class="token class-name">Composition</span> <span class="token punctuation">(</span><span class="token class-name">Compositor</span> compositor<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>compositor <span class="token operator">=</span> compositor<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">repair</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>Quando um novo layout √© requerido, a composi√ß√£o solicita ao seu compositor determinar onde colocar as quebras de linha. A composi√ß√£o passa para o compositor tr√™s vetores que definem tamanhos naturais, extensibilidades e compressibilidades dos componentes. Ela tamb√©m passa o n√∫mero de componentes, a largura da linha e um vetor que o compositor preenche com a posi√ß√£o de cada quebra de linha. O compositor devolve o n√∫mero de quebras calculadas.</p> <p>A interface de Compositor permite √† composi√ß√£o passar ao compositor toda a informa√ß√£o de que ele necessita. Isso √© um exemplo da abordagem do tipo &quot;levando os dados para a estrat√©gia&quot;:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Compositor</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">compose</span><span class="token punctuation">(</span><span class="token class-name">Coord</span> natural<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token class-name">Coord</span> stretch<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token class-name">Coord</span> shrink<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> componentCount<span class="token punctuation">,</span> <span class="token keyword">int</span> lineWidth<span class="token punctuation">,</span> <span class="token keyword">int</span> breaks<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Note que compositor √© uma classe abstrata (ou interface). As subclasses concretas definem estrat√©gias espec√≠ficas de quebras de linha.</p> <p>A composi√ß√£o chama a opera√ß√£o <em>repair</em> do seu compositor. <em>repair</em> primeiramente inicia vetores com tamanho, extensibilidade e compressibilidade naturais de cada componente (cujos detalhes omitiremos). Ent√£o, ela chama o compositor para obter as quebras de linha e finalmente estabelece o layout dos componentes de acordo com as quebras (tamb√©m omitido):</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">repair</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">Coord</span><span class="token punctuation">[</span><span class="token punctuation">]</span> natural<span class="token punctuation">;</span>
    <span class="token class-name">Coord</span><span class="token punctuation">[</span><span class="token punctuation">]</span> stretchability<span class="token operator">:</span>
    <span class="token class-name">Coord</span><span class="token punctuation">[</span><span class="token punctuation">]</span> shrinkability<span class="token punctuation">;</span>
    <span class="token keyword">int</span> componentCount<span class="token punctuation">;</span>
    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> breaks<span class="token punctuation">;</span>
    <span class="token comment">// prepara os arrays com os tamanhos desejados dos componentes</span>
    <span class="token comment">//...</span>
    <span class="token comment">// determina onde est√£o as quebras:</span>
    <span class="token keyword">int</span> breakCount<span class="token punctuation">;</span>
    breakCount <span class="token operator">=</span> compositor<span class="token punctuation">.</span><span class="token function">compose</span><span class="token punctuation">(</span>natural<span class="token punctuation">,</span> stretchability<span class="token punctuation">,</span> shrinkability<span class="token punctuation">,</span>componentCount<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lineWidth<span class="token punctuation">,</span> breaks<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// disp√µe os componentes de acordo com as quebras</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>Examinemos agora as subclasses de Compositor. A classe SimpleCompositor examina componentes uma linha por vez para determinar onde as quebras deveriam ser colocadas:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SimpleCompositor</span> <span class="token keyword">implements</span> <span class="token class-name">Compositor</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">SimpleCompositor</span><span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">compose</span><span class="token punctuation">(</span><span class="token class-name">Coord</span> natural<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token class-name">Coord</span> stretch<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token class-name">Coord</span> shrink<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> componentCount<span class="token punctuation">,</span> <span class="token keyword">int</span> lineWidth<span class="token punctuation">,</span> <span class="token keyword">int</span> breaks<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//...    </span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>O <em>TexCompositor</em> utiliza uma estrat√©gia mais global. Ele examina um par√°grafo por vez, levando em conta o tamanho dos componentes e sua extensibilidade. Ele tamb√©m tenta dar um &quot;aspecto&quot; uniforme ao par√°grafo atrav√©s da minimiza√ß√£o dos espa√ßos em branco entre componentes.</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TexCompositor</span> <span class="token keyword">implements</span> <span class="token class-name">Compositor</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">TexCompositor</span><span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">compose</span><span class="token punctuation">(</span><span class="token class-name">Coord</span> natural<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token class-name">Coord</span> stretch<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token class-name">Coord</span> shrink<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> componentCount<span class="token punctuation">,</span> <span class="token keyword">int</span> lineWidth<span class="token punctuation">,</span> <span class="token keyword">int</span> breaks<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//...    </span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>ArrayCompositor quebra os componentes em linhas a intervalos regulares.</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ArrayCompositor</span> <span class="token keyword">implements</span> <span class="token class-name">Compositor</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">ArrayCompositor</span><span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">compose</span><span class="token punctuation">(</span><span class="token class-name">Coord</span> natural<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token class-name">Coord</span> stretch<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token class-name">Coord</span> shrink<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> componentCount<span class="token punctuation">,</span> <span class="token keyword">int</span> lineWidth<span class="token punctuation">,</span> <span class="token keyword">int</span> breaks<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//...    </span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>Essas classes n√£o utilizam toda a informa√ß√£o passada em <code>Compose</code>. O <code>SimpleCompositor</code> ignora a extensibilidade dos componentes, levando em conta somente suas larguras naturais. O <code>TeXCompositor</code> utiliza toda a informa√ß√£o passada para ela, enquanto que <code>ArrayCompositor</code> ignora todas.</p> <p>Para instanciar composition, voc√™ passa a ela o compositor que deseja usar:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Composition</span> quick <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Composition</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SimpleCompositor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Composition</span> slick <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Composition</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TexCompositor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Composition</span> iconic <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Composition</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ArrayCompositor</span> <span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>A interface de Compositor √© cuidadosamente projetada para suportar todos os algoritmos de layout que as subclasses possam implementar. Voc√™ n√£o deseja ter que mudar esta interface a cada nova subclasse introduzida porque isso exigir√° mudar subclasses existentes. Em geral, as interfaces de Strategy eContext determinam tamb√©m qual padr√£o consegue o seu intento.</p> <h2 id="usos-conhecidos"><a href="#usos-conhecidos" class="header-anchor">#</a> Usos conhecidos</h2> <p>Tanto ET++ [WGM88] como InterViews usam estrat√©gias para encapsular diferentes algoritmos de quebras de linhas na forma como descrevemos.</p> <p>No sistema RTL destinado a otimiza√ß√£o de c√≥digo gerado por compiladores [JML92], estrat√©gias definem diferentes esquemas de aloca√ß√£o de registradores (Register Allocator) e procedimentos de utiliza√ß√£o (scheduling) do conjunto de instru√ß√µes (RISCscheduler, CISCscheduler). Isso fornece flexibilidade no direcionamento do otimizador para diferentes arquiteturas de m√°quina.</p> <p>O framework para calculadoras <em>(calculation engine)</em> do SwapsManager de ET++ computa pre√ßos para diferentes instrumentos financeiros [EG92]. Suas abstra√ß√µes-chave s√£o Instrumente YieldCurve (instrumento e curva de rendimentos, respectivamente). Diferentes instrumentos s√£o implementados como subclasses de Instrument. YieldCurve calcula coeficientes de desconto que determinam o valor presente de fluxos de caixa futuros. Ambas as classes delegam algum comportamento para objetos Strategy. O framework fornece uma fam√≠lia de classes Concrete Strategy para gerar fluxos de caixa, avaliar permutas (swaps) e calcular coeficientes de desconto. Voc√™ pode criar novas calculadoras atrav√©s da configura√ß√£o de Instrument e YieldCurve com diferentes objetos Concrete Strategy. Esta abordagem suporta a combina√ß√£o e casamento de implementa√ß√µes existentes de Strategy, bem como a defini√ß√£o de novas implementa√ß√µes.</p> <p>Os componentes de Booch usam estrat√©gias como argumentos-template. As classes de cole√ß√£o de Booch suportam tr√™s tipos diferentes de estrat√©gias de aloca√ß√£o de mem√≥ria: administrada (aloca√ß√£o dentro de um pool), controlada (aloca√ß√µes/ desaloca√ß√µes s√£o protegidas por travamentos (locks), e n√£o-administradas (o alocador de mem√≥ria normal). Essas estrat√©gias s√£o passadas como argumentos-template para uma classe de cole√ß√£o quando ela √© instanciada. Por exemplo, uma Unbounded- Collection que usa a estrat√©gia n√£o-administrada √© instanciada como UnboundedCollection&lt;MyItemType*, Unnanaged&gt;,</p> <p>RApp √© um sistema para o layout de circuitos integrados [GA89,AG90]. RAPP deve estabelecer o layout e as rotas dos condutores que conectam subsistemas do circuito. Algoritmos para determina√ß√£o de rotas no RApp s√£o definidos como subclasses de uma classe abstrata Router. A Router √© uma classe Strategy.</p> <p>ObjectWindows da Borland [Bor94] utiliza estrat√©gias em caixas de di√°logo para assegurar que os usu√°rios forne√ßam dados v√°lidos. Por exemplo, os n√∫meros devem estar em um certo intervalo, e um campo de entrada num√©rica deve aceitar somente d√≠gitos. Validar que uma string est√° correta pode exigir uma pesquisa numa tabela</p> <p>ObjectWindows utiliza objetos Validator para encapsular estrat√©gias de valida√ß√£o. Validators s√£o exemplos de objetos Strategy. Campos de entrada de dados delegam a estrat√©gia de valida√ß√£o para um objeto Validator opcional. O cliente associa um validator a um campo, se for necess√°ria uma valida√ß√£o (isto √©, um exemplo de uma estrat√©gia opcional). Quando o di√°logo √© fechado, os campos de entrada solicitam aos seus validators para validarem os dados. A biblioteca de classes fornece validators para casos comuns, tal como um RangeValidator (um validator de intervalo) para n√∫meros. Novas estrat√©gias de valida√ß√£o, espec√≠ficas do cliente, podem ser definidas facilmente, criando subclasses da classe Validator.</p> <h2 id="padrao-relacionados"><a href="#padrao-relacionados" class="header-anchor">#</a> Padr√£o relacionados</h2> <p><a href="/vuepressppr/gof/Flyweight.html">Flyweight</a>: objetos Strategy geralmente s√£o bons flyweights.</p> <h2 id="referencias"><a href="#referencias" class="header-anchor">#</a> Refer√™ncias</h2> <hr class="footnotes-sep"> <section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p>GAMMA, Erich. et al. Padr√µes de projetos: Solu√ß√µes reutiliz√°veis de software orientados a objetos Bookman editora, 2009. <a href="#fnref1" class="footnote-backref">‚Ü©Ô∏é</a></p></li></ol></section></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/leandro-costa/vuepressppr/edit/master/src/gof/Strategy.md" target="_blank" rel="noopener noreferrer">Edit!</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">7/28/2021, 11:19:58 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ‚Üê
      <a href="/vuepressppr/03_GOF.html" class="prev">
        GOF üî®
      </a></span> <!----></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/vuepressppr/assets/js/app.bbe71492.js" defer></script><script src="/vuepressppr/assets/js/2.9af12a35.js" defer></script><script src="/vuepressppr/assets/js/17.200cc9cd.js" defer></script><script src="/vuepressppr/assets/js/3.6a601bc8.js" defer></script>
  </body>
</html>
