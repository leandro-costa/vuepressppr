<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Abstract Factory (GOF) ‚úÖ | Padr√µes de Projetos</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css">
    <link rel="icon" href="/vuepressppr/logo.png">
    <link rel="manifest" href="/vuepressppr/manifest.json">
    <link rel="apple-touch-icon" href="/vuepressppr/icon-192x192.png">
    <link rel="mask-icon" href="/vuepressppr/icon-192x192.png" color="#3eaf7c">
    <meta name="description" content="Material para as aulas da disciplina de Padr√µes de Projetos">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icon-192x192.png">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/vuepressppr/assets/css/0.styles.47a93a5c.css" as="style"><link rel="preload" href="/vuepressppr/assets/js/app.ce4f41d5.js" as="script"><link rel="preload" href="/vuepressppr/assets/js/2.c734147e.js" as="script"><link rel="preload" href="/vuepressppr/assets/js/15.d9f7bce3.js" as="script"><link rel="preload" href="/vuepressppr/assets/js/6.28e79f91.js" as="script"><link rel="preload" href="/vuepressppr/assets/js/3.8fef2960.js" as="script"><link rel="prefetch" href="/vuepressppr/assets/js/10.2686d00a.js"><link rel="prefetch" href="/vuepressppr/assets/js/11.a34fa059.js"><link rel="prefetch" href="/vuepressppr/assets/js/12.4be18eab.js"><link rel="prefetch" href="/vuepressppr/assets/js/13.50a69951.js"><link rel="prefetch" href="/vuepressppr/assets/js/14.77172f79.js"><link rel="prefetch" href="/vuepressppr/assets/js/16.62b40c52.js"><link rel="prefetch" href="/vuepressppr/assets/js/17.23744b32.js"><link rel="prefetch" href="/vuepressppr/assets/js/18.58e0d5b7.js"><link rel="prefetch" href="/vuepressppr/assets/js/19.b77f9077.js"><link rel="prefetch" href="/vuepressppr/assets/js/20.3ea45df6.js"><link rel="prefetch" href="/vuepressppr/assets/js/21.27cb1590.js"><link rel="prefetch" href="/vuepressppr/assets/js/22.8c6a7104.js"><link rel="prefetch" href="/vuepressppr/assets/js/23.31801bca.js"><link rel="prefetch" href="/vuepressppr/assets/js/4.78ef4b59.js"><link rel="prefetch" href="/vuepressppr/assets/js/5.2b7133b0.js"><link rel="prefetch" href="/vuepressppr/assets/js/7.a41c72a8.js"><link rel="prefetch" href="/vuepressppr/assets/js/8.c3a503dd.js"><link rel="prefetch" href="/vuepressppr/assets/js/9.d53cccfb.js">
    <link rel="stylesheet" href="/vuepressppr/assets/css/0.styles.47a93a5c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuepressppr/" class="home-link router-link-active"><!----> <span class="site-name">Padr√µes de Projetos</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/leandro-costa/vuepressppr" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/leandro-costa/vuepressppr" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Abstract Factory (GOF) ‚úÖ</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vuepressppr/gof/AbstractFactory/#intencao" class="sidebar-link">Inten√ß√£o</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/AbstractFactory/#tambem-conhecido-como" class="sidebar-link">Tamb√©m conhecido como</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/AbstractFactory/#motivacao" class="sidebar-link">Motiva√ß√£o</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/AbstractFactory/#aplicabilidade" class="sidebar-link">Aplicabilidade</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/AbstractFactory/#estrutura" class="sidebar-link">Estrutura</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/AbstractFactory/#participantes" class="sidebar-link">Participantes</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/AbstractFactory/#colaboracoes" class="sidebar-link">Colabora√ß√µes</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/AbstractFactory/#consequencias" class="sidebar-link">Consequ√™ncias</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/AbstractFactory/#implementacao" class="sidebar-link">Implementa√ß√£o</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/AbstractFactory/#exemplo-de-codigo" class="sidebar-link">Exemplo de c√≥digo</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/AbstractFactory/#usos-conhecidos" class="sidebar-link">Usos conhecidos</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/AbstractFactory/#padrao-relacionados" class="sidebar-link">Padr√£o relacionados</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/AbstractFactory/#referencias" class="sidebar-link">Refer√™ncias</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="abstract-factory-gof-‚úÖ"><a href="#abstract-factory-gof-‚úÖ" class="header-anchor">#</a> Abstract Factory (GOF) ‚úÖ</h1> <h2 id="intencao"><a href="#intencao" class="header-anchor">#</a> Inten√ß√£o</h2> <p>Fornecer uma interface para cria√ß√£o de fam√≠lias de objetos relacionados ou dependentes sem especificar suas classes concretas.</p> <h2 id="tambem-conhecido-como"><a href="#tambem-conhecido-como" class="header-anchor">#</a> Tamb√©m conhecido como</h2> <p>Kit</p> <h2 id="motivacao"><a href="#motivacao" class="header-anchor">#</a> Motiva√ß√£o</h2> <p>Considere um toolkit para constru√ß√£o de interfaces de usu√°rios que suporte m√∫ltiplos estilos de intera√ß√£o (look-and-feel) tais como o <em>Motif</em> e o <em>Presentation Manager</em>. Diferentes estilos de intera√ß√£o definem diferentes apresenta√ß√µes e comportamento para os widgets de uma interface de usu√°rio, tais como barras de rolamento, janelas e bot√µes. Para ser port√°til entre v√°rios estilos de apar√™ncia, uma aplica√ß√£o n√£o deve codificar rigidamente seus widgets para um determinado padr√£o. Instanciando classes espec√≠ficas de estilo de intera√ß√£o para os widgets pela aplica√ß√£o toda, torna dif√≠cil mudar o estilo no futuro.</p> <p>Podemos resolver esse problema definindo uma classe abstrata <code>WidgetFactory</code> que declara uma interface para cria√ß√£o de cada tipo b√°sico de widget. Existe tamb√©m uma classe abstrata para cada tipo de widget, e subclasses concretas implementam os widgets para intera√ß√£o. A interface de <code>WidgetFactory</code> tem uma opera√ß√£o que retorna um novo objeto widget para cada classe abstrata de widget. Os clientes chamam estas opera√ß√µes para obter inst√¢ncias de widget, mas n√£o t√™m conhecimento das classes concretas que est√£o usando. Desta forma, os clientes ficam independentes do padr√£o de intera√ß√£o usado no momento.</p> <figure><img src="https://www.plantuml.com/plantuml/svg/dLF1YiCW4BtFLynnzv1yGGcbXRqL5lRGiz5fAvYuw9HIclxxIjCOJQM7zQA-UVFUp8XhpyBnkJCWMizEI4PfXFUur-f8_1K0wwutmB1k4-MEqf5WskjUsSl7Ppdw8vqrPYDS8Dm1HjcTPNqeQ1S4twXyx_ulyLe1LjNGv0t3mg540TqpkOEGXADfKbnoVVez41XtN0rr7Ma9bd5d-TX0T5WYZyGPX7XyMisXFBBCsnfDmJQqsqnDfT3CpAUpgYgSU02b4TTDDeWtZAIQvIC4IfnQCPRadhGYfEwNhoYOdMxFJ3v5E-AJLHvWJRqA7-0F" alt="uml diagram"> <figcaption>Toolkit para constru√ß√£o de interfaces gr√°ficas.</figcaption></figure> <p>Existe uma subclasse concreta de <code>WidgetFactory</code> para cada estilo de intera√ß√£o. Cada subclasse implementa as opera√ß√µes para criar o widget apropriado para aquele estilo de intera√ß√£o. Por exemplo, a opera√ß√£o <code>createScrollBar</code> aplicada √† <code>MotifWidgetFactory</code> instancia e retorna uma barra de rolamento de acordo com o Motif, enquanto que a correspondente opera√ß√£o aplicada √† <code>PMWidgetFactory</code> retorna uma barra de rolamento para o Presentation Manager. Os clientes criam widgets exclusivamente atrav√©s da interface de <code>WidgetFactory</code> e n√£o tem conhecimento das classes que implementam os widgets para um padr√£o em particular. Em outras palavras, os clientes t√™m somente que se comprometer com uma interface definida por uma classe abstrata, n√£o uma determinada classe concreta. Uma <code>WidgetFactory</code> tamb√©m implementa e garante as depend√™ncias entre as classes concretas de widgets. Uma barra de rolamento Motif deveria ser usada com um bot√£o Motif e um editor de textos Motif, e essa restri√ß√£o √© garantida automaticamente como consequ√™ncia de usar uma <code>MotifWidgetFactory</code>.</p> <h2 id="aplicabilidade"><a href="#aplicabilidade" class="header-anchor">#</a> Aplicabilidade</h2> <p>Use o padr√£o Abstract Factory quando:</p> <ul><li>um sistema deve ser independente de como seus produtos s√£o criados, compostos ou representados;</li> <li>um sistema deve ser configurado como um produto de uma fam√≠lia de m√∫ltiplos produtos;</li> <li>uma fam√≠lia de objetos-produto for projetada para ser usada em conjunto, e voc√™ necessita garantir esta restri√ß√£o;</li> <li>voc√™ quer fornecer uma biblioteca de classes de produtos e quer revelar somente suas interfaces, n√£o suas implementa√ß√µes.</li></ul> <h2 id="estrutura"><a href="#estrutura" class="header-anchor">#</a> Estrutura</h2> <figure><img src="https://www.plantuml.com/plantuml/svg/bLF1QiCm3BthAtJS3Wd4vnBQ57OkxB2pwsZKuCJ3LXYbxRzFB4cNkIPi1X-az_Ia9-DjP1ruw1peO-IW3QDnEaRSJU6BN1_E5q0vbvbqGnD8CxtPllMVJyzvzDK4xroZWn1k0AFmtlU2Cat2rQYSaVkxXlgNHZe05iMrJlscB9LdWUsPmhisT8SEmRU3uTqqwXog9Au0nabnSotB7rOcMQsqQNxBDbKIAu2x-wMe4FDvATWxIz9F7DUFhbR01fBruAOeS2u0UDnyMI_siO9-JvK-oA9OhQ5Y5Kws9QJkWy-ecOCz3anncUs8JxwD05lgM_aENm00" alt="uml diagram"> <figcaption>Estrutura do Abstract Factory.</figcaption></figure> <h2 id="participantes"><a href="#participantes" class="header-anchor">#</a> Participantes</h2> <ul><li><strong>AbstractFactory</strong> (WidgetFactory)
<ul><li>declara uma interface para opera√ß√µes que criam objetos-produto abstratos.</li></ul></li> <li><strong>ConcreteFactory</strong> (MotifWidgetFactory, PMWidgetFactory)
<ul><li>implementa as opera√ß√µes que criam objetos-produto concretos.</li></ul></li> <li><strong>AbstractProduct</strong> (Window, ScrollBar)
<ul><li>declara uma interface para um tipo de objeto-produto</li></ul></li> <li><strong>ConcreteProduct</strong> (MotifWindow, MotifScrollBar)
<ul><li>define um objeto-produto a ser criado pela correspondente f√°brica concreta.</li> <li>implementa a interface de Abstract Product.</li></ul></li> <li><strong>Client</strong> <ul><li>usa somente interfaces declaradas pelas classes Abstract Factory e Abstract Product.</li></ul></li></ul> <h2 id="colaboracoes"><a href="#colaboracoes" class="header-anchor">#</a> Colabora√ß√µes</h2> <ul><li>Normalmente uma √∫nica inst√¢ncia de uma classe ConcreteFactory √© criada em tempo de execu√ß√£o. Essa f√°brica concreta cria objetos-produto que t√™m uma implementa√ß√£o particular. Para criar diferentes objetos-produto, os clientes deveriam usar uma f√°brica concreta diferente.</li> <li>AbstractFactory adia a cria√ß√£o dos objetos-produto para as suas subclasses ConcreteFactory.</li></ul> <h2 id="consequencias"><a href="#consequencias" class="header-anchor">#</a> Consequ√™ncias</h2> <p>O padr√£o Abstract Factory tem os seguintes benef√≠cios e desvantagens:</p> <ol><li>Ele isola as classes concretas. O padr√£o Abstract Factory ajuda a controlar as classes de objetos criadas por uma aplica√ß√£o. Uma vez que a f√°brica encapsula a responsabilidade e o processo de criar objetos-produto, isola os clientes das classes de implementa√ß√£o. Os clientes manipulam as inst√¢ncias atrav√©s das suas interfaces abstratas. Nomes de classes-produto ficam isolados na implementa√ß√£o da f√°brica concreta; eles n√£o aparecem no c√≥digo do cliente.</li> <li>Ele torna f√°cil a troca de fam√≠lias de produtos. A classe de uma f√°brica concreta aparece apenas uma vez numa aplica√ß√£o ‚Äî isto √©, quando √© instanciada. Isso torna f√°cil mudar a f√°brica concreta que uma aplica√ß√£o usa. Ela pode usar diferentes configura√ß√µes de produtos simplesmente trocando a f√°brica con- creta. Uma vez que a f√°brica abstrata cria uma fam√≠lia completa de produtos, toda fam√≠lia de produtos muda de uma s√≥ vez. No nosso exemplo de interface de usu√°rio, podemos mudar de widgets do Motif para widgets do Presentation Manager simplesmente trocando os correspondentes objetos- f√°brica e recriando a interface.</li> <li>Ela promove a harmonia entre produtos. Quando objetos-produto numa fam√≠lia s√£o projetados para trabalharem juntos, √© importante que uma aplica√ß√£o use objetos de somente uma fam√≠lia de cada vez. AbstractFactory torna f√°cil assegurar isso.</li> <li>√â dif√≠cil de suportar novos tipos de produtos. Estender f√°bricas abstratas para produzir novos tipos de Produtos n√£o √© f√°cil. Isso se deve ao fato de que a interface de AbstractFactory fixa o conjunto de produtos que podem ser criados. Suportar novos tipos de produto exige estender a interface da f√°brica, o que envolve mudar a classe AbstractFactory e todas as suas subclasses. Discutimos uma solu√ß√£o para este problema na se√ß√£o de Implementa√ß√£o.</li></ol> <h2 id="implementacao"><a href="#implementacao" class="header-anchor">#</a> Implementa√ß√£o</h2> <p>A seguir apresentamos algumas t√©cnicas √∫teis para implementar o padr√£o Abstract Factory.</p> <ol><li><p><em>F√°bricas como singletons.</em> Uma aplica√ß√£o necessita somente de uma inst√¢ncia de uma Concrete Factory por fam√≠lia de produto. Assim, ela √© normalmente melhor implementada como um <a href="../Singleton">Singleton</a>.</p></li> <li><p><em>Criando os produtos.</em> AbstractFactory somente declara uma interface para cria√ß√£o de produtos. Fica a cargo das subclasses de ConcreteProducts cri√°-los efetivamente. A maneira mais comum de fazer isso √© definir um m√©todo-f√°brica (<a href="../FactoryMethod">Factory Method</a>) para cada produto. Uma f√°brica concreta especificar√° seus produtos redefinindo (overriding) o m√©todo-f√°brica para cada um. Embora esta implementa√ß√£o seja simples, exige uma nova subclasse de uma f√°brica concreta para cada fam√≠lia de produtos, ainda que as fam√≠lias de produto tenham somente diferen√ßas pequenas.</p> <p>Se muitas fam√≠lias de produtos s√£o poss√≠veis, a f√°brica concreta pode ser implementada usando o padr√£o <a href="../Prototype">Prototype</a>. A f√°brica concreta √© iniciada com uma inst√¢ncia protot√≠pica de cada produto da fam√≠lia e cria um novo produto clonando o seu prot√≥tipo. A abordagem baseada no Prototype elimina a necessidade de uma nova classe de f√°brica concreta para cada nova fam√≠lia de produtos. Aqui apresentamos uma maneira de implementar em Smalltalk uma f√°brica baseada no Prototype. A f√°brica concreta armazena os prot√≥tipos a serem clonados em um dicion√°rio chamado <code>partCatalog</code>. O m√©todo <code>make</code>: l√™ o prot√≥tipo e faz sua clonagem:</p> <div class="language-smalltalk line-numbers-mode"><pre class="language-smalltalk"><code>make<span class="token punctuation">:</span> partName 
    <span class="token punctuation">(</span>partcatalog at<span class="token punctuation">:</span> partName<span class="token punctuation">)</span> copy
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>A f√°brica concreta tem um m√©todo para adicionar partes ao cat√°logo.</p> <div class="language-smalltalk line-numbers-mode"><pre class="language-smalltalk"><code>addPart<span class="token punctuation">:</span> partTemp1ate named<span class="token punctuation">:</span> partName
    partCataIog at<span class="token punctuation">:</span> partName put<span class="token punctuation">:</span> partTempIate
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Prot√≥tipos s√£o acrescentados √† f√°brica, identificando-os com um s√≠mbolo:</p> <div class="language-smalltalk line-numbers-mode"><pre class="language-smalltalk"><code>aFactory addPart<span class="token punctuation">:</span> aPrototype named<span class="token punctuation">:</span> <span class="token symbol">#ACMERidget</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Uma varia√ß√£o da abordagem baseada no Prototype √© poss√≠vel em linguagens que tratam classes como objetos de primeira classe (por exemplo, Smalltalk e Objective C).</p> <p>Voc√™ pode pensar sobre uma classe nessas linguagens como sendo uma f√°brica degenerada que cria somente um tipo de produto. Pode armazenar classes dentro de uma f√°brica concreta que cria os v√°rios produtos concretos em vari√°veis, de maneira bastante semelhante a prot√≥tipos. Essas classes criam novas inst√¢ncias em nome da f√°brica concreta. Define-se uma nova f√°brica iniciando uma f√°brica concreta com classes de produtos ao inv√©s de usar subclasses. Esta abordagem aproveita as caracter√≠sticas da linguagem, ao passo que a abordagem pura baseada em prot√≥tipos √© independente de linguagens.</p> <p>Como a f√°brica baseada em prot√≥tipos em Smalltalk que acabamos de discutir, a vers√£o baseada em classes ter√° uma √∫nica vari√°vel de inst√¢ncia <code>partCatalog</code>, que √© um dicion√°rio cuja chave √© o nome da parte. Em vez de armazenar prot√≥tipos para serem clonados, partCatalog armazena as classes dos produtos. O m√©todo make: agora se parece com o seguinte:</p> <div class="language-smalltalk line-numbers-mode"><pre class="language-smalltalk"><code>make<span class="token punctuation">:</span> partName
    <span class="token punctuation">(</span>partCataIog at<span class="token punctuation">:</span> partName<span class="token punctuation">)</span> <span class="token keyword">new</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p><em>Definindo f√°bricas extens√≠veis.</em> AbstractFactory normalmente define uma ope- ra√ß√£o diferente para cada tipo de produto que pode produzir. Os tipos de produtos est√£o codificados nas assinaturas das opera√ß√µes. O acr√©scimo de um novo tipo de produto exige a mudan√ßa da interface de AbstractFactory e de todas as classes que dependem dela.</p> <p>Um projeto mais flex√≠vel, mas menos seguro, √© acrescentar um par√¢metro √†s opera√ß√µes que criam objetos. Este par√¢metro especifica o tipo de objeto a ser criado. Ele poderia ser um identificador de classe, um inteiro, um string ou qualquer outra coisa que identifica o tipo de produto. De fato, com esta abordagem, AbstractFactory somente necessita uma √∫nica opera√ß√£o &quot;Make&quot; com um par√¢metro indicando um tipo de objeto a ser criado. Esta √© a t√©cnica usada em Prototype e nas f√°bricas abstratas baseadas em classe, discutidas anteriormente.</p> <p>Essa varia√ß√£o √© mais f√°cil de usar numa linguagem com tipos dinamicamente definidos como Smalltalk, do que numa linguagem com tipos estaticamente definidos como C++. Voc√™ pode us√°-la em C++ somente quando todos os objetos t√™m a mesma classe abstrata de base ou quando os objetos-produto podem ser seguramente for√ßados a serem do tipo correto pelo cliente que os solicitou. A se√ß√£o de implementa√ß√£o de <a href="../FactoryMethod">Factory Method</a> mostra como implementar tais opera√ß√µes parametrizadas em C++.</p> <p>Mas mesmo quando n√£o √© necess√°rio for√ßar o tipo correto, permanece um problema inerente: todos os produtos s√£o retornados ao cliente com a mesma interface abstrata conforme especificado pelo tipo de retorno. O cliente n√£o ser√° capaz de diferenciar ou fazer hip√≥teses seguras sobre a classe de um produto. Se os clientes necessitam excetuar opera√ß√µes espec√≠ficas √†s subclasses, elas n√£o ser√£o acess√≠veis atrav√©s da interface abstrata. Embora o cliente possa executar um <em>downcast</em> (por exemplo, com <em>dynamic_cast</em> em C++), isso n√£o √© sempre vi√°vel ou seguro porque o <em>downcast</em> pode falhar. Este √© o cl√°ssico compromisso para se obter uma interface altamente flex√≠vel e extens√≠vel.</p></li></ol> <h2 id="exemplo-de-codigo"><a href="#exemplo-de-codigo" class="header-anchor">#</a> Exemplo de c√≥digo</h2> <p>Aplicaremos o padr√£o Abstract Factory para criar os labirintos que discutimos nos outros padr√µes.</p> <p>A classe <code>MazeFactory</code> pode criar componentes de labirintos. Ela constr√≥i salas, paredes e portas entre salas. Pode ser usada por um programa que l√™ plantas de labirintos de um arquivo e constr√≥i o labirinto correspondente. Ou pode ser usada por um programa que constr√≥i labirintos aleatoriamente. Os programas que constr√≥em labirintos recebem <code>MazeFactory</code> como argumento, de maneira que o programador pode especificar as classes de salas, paredes e portas a serem constru√≠das.</p> <!----> <p><code>CreateMaze</code> constr√≥i um pequeno labirinto consistindo em duas salas com uma porta entre elas. <code>CreateMaze</code> codifica de maneira r√≠gida os nomes das classes, tornando dif√≠cil criar labirintos com componentes diferentes.</p> <p>src/gof/AbstractFactory/CreateMazeOriginal.java</p> <p>Aqui apresentamos uma vers√£o de <code>CreateMaze</code> que corrige essa falha aceitando uma <code>MazeFactory</code> como um par√¢metro:</p> <!----> <p>Podemos criar <code>EnchantedMazeFactory</code>, uma f√°brica para labirintos encantados, introduzindo subclasses de <code>MazeFactory</code>. <code>EnchantedMazeFactory</code> redefinir√° diferentes fun√ß√µes-membro e retornar√° diferentes subclasses de <code>Room</code>, <code>Wall</code>, etc.</p> <!----> <p>Suponha agora que queiramos construir um jogo de labirinto no qual uma sala pode ter uma bomba colocada nela. Se a bomba detona, ela danificar√° as paredes (no m√≠nimo). Podemos construir uma subclasse de <code>Room</code> para registrar se uma sala tem uma bomba nela e se a bomba explodiu. Tamb√©m necessitaremos de uma subclasse de <code>Wall</code> para manter o registro do dano feito √† parede. Chamaremos estas classes de <code>RoomWithABomb</code> e <code>BombedWall</code>.</p> <p>A √∫ltima classe que definiremos √© <code>BombedMazeFactory</code>, uma subclasse de <code>MazeFactory</code> que assegura que as paredes s√£o da classe <code>BombedWall</code> e as salas s√£o da classe <code>RoomRithABomb</code>. <code>BombedMazeFactory</code> somente necessita redefinir duas fun√ß√µes:</p> <!----> <p>Para construir um simples labirinto que pode conter bombas, simplesmente chamamos <code>CreateMaze</code> com uma <code>BombedMazeFactory</code>.</p> <!----> <p>CreateMaze pode receber uma inst√¢ncia de EnchantedMazeFactory da mesma maneira para construir labirintos encantados.</p> <p>Note que a <code>MazeFactory</code> √© apenas uma cole√ß√£o de m√©todos de f√°bricas. Essa √© a maneira mais comum de implementar o padr√£o Abstract Factory. Note tamb√©m que <code>MazeFactory</code> n√£o √© uma classe abstrata; assim, ela funciona tanto como AbstractFactory quanto como ConcreteFactory. Esta √© uma outra implementa√ß√£o comum para aplica√ß√µes simples do padr√£o Abstract Factory. Porque a <code>MazeFactory</code> √© uma classe concreta que consiste inteiramente de m√©todos de f√°bricas, √© f√°cil criar uma nova <code>MazeFactory</code> criando uma subclasse e redefinindo as opera√ß√µes que necessitam ser mudadas.</p> <p><code>CreateMaze</code> usou a opera√ß√£o <code>SetSide</code> sobre as salas para especificar os seus lados. Se ela cria salas com uma <code>BombedMazeFactory</code>, ent√£o o labirinto ser√° constitu√≠do de objetos <code>RoomWithABomb</code>, com lados <code>BombedWall</code>. Se <code>RoomWithABomb</code> tivesse que acessar um membro espec√≠fico de uma subclasse de <code>BombedWall</code>, ent√£o ele teria que fazer um <em>cast</em> para uma refer√™ncia a suas paredes de <code>Wall</code> para <code>BombedWall</code>. Este <em>downcasting</em> √© seguro na medida que o argumento √© de fato uma <code>BombedWall</code>, o que √© certamente verdadeiro se as paredes s√£o constru√≠das exclusivamente com uma <code>BombedMazeFactory</code>.</p> <h2 id="usos-conhecidos"><a href="#usos-conhecidos" class="header-anchor">#</a> Usos conhecidos</h2> <p>Inter Views usa o sufixo &quot;Kit&quot; [Lin92] para denotar classes AbstractFactory. Ela define f√°bricas abstratas WidgetKit e DialogKit para gera√ß√£o de objetos espec√≠ficos da interface de usu√°rio para intera√ß√£o. InterViews tamb√©m inclui LayoutKit, que gera diferentes objetos por composi√ß√£o dependendo do layout desejado. Por exemplo, um layout que √© conceitualmente horizontal pode exigir diferentes objetos compostos, dependendo da orienta√ß√£o do documento (retrato ou paisagem).</p> <p>ET++ [WGM88] usa o padr√£o Abstract Factory para obter portabilidade entre diferentes sistemas de janelas (X Windows e SunView, por exemplo). A classe abstrata base WindowSystem define a interface para criar objetos que representam recursos do sistema de janelas (MakeWindow, MakeFont, MakeColor, por exemplo). As subclasses concretas implementam as interfaces para um sistema de janelas espec√≠fico. Em tempo de execu√ß√£o, ET++ cria uma inst√¢ncia de uma subclasse concreta WindowSystem que cria objetos concretos para os recursos do sistema.</p> <h2 id="padrao-relacionados"><a href="#padrao-relacionados" class="header-anchor">#</a> Padr√£o relacionados</h2> <p>As classes AbstractFactory s√£o frequentemente implementadas com m√©todos-f√°brica <a href="../FactoryMethod">Factory Method</a>, mas elas tamb√©m podem ser implementadas usando <a href="../Prototype">Prototype</a>.</p> <p>Uma f√°brica concreta √© frequentemente um <a href="../Singleton">Singleton</a>.</p> <h2 id="referencias"><a href="#referencias" class="header-anchor">#</a> Refer√™ncias</h2></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/leandro-costa/vuepressppr/edit/master/src/gof/AbstractFactory/README.md" target="_blank" rel="noopener noreferrer">Edit!</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">8/11/2021, 9:17:50 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ‚Üê
      <a href="/vuepressppr/03_GOF.html" class="prev">
        GOF üî®
      </a></span> <!----></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/vuepressppr/assets/js/app.ce4f41d5.js" defer></script><script src="/vuepressppr/assets/js/2.c734147e.js" defer></script><script src="/vuepressppr/assets/js/15.d9f7bce3.js" defer></script><script src="/vuepressppr/assets/js/6.28e79f91.js" defer></script><script src="/vuepressppr/assets/js/3.8fef2960.js" defer></script>
  </body>
</html>
