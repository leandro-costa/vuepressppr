<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Prototype (GOF) üî® | Padr√µes de Projetos</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css">
    <link rel="icon" href="/vuepressppr/logo.png">
    <link rel="manifest" href="/vuepressppr/manifest.json">
    <link rel="apple-touch-icon" href="/vuepressppr/icon-192x192.png">
    <link rel="mask-icon" href="/vuepressppr/icon-192x192.png" color="#3eaf7c">
    <meta name="description" content="Material para as aulas da disciplina de Padr√µes de Projetos">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icon-192x192.png">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/vuepressppr/assets/css/0.styles.47a93a5c.css" as="style"><link rel="preload" href="/vuepressppr/assets/js/app.c089e0e7.js" as="script"><link rel="preload" href="/vuepressppr/assets/js/2.63c38da0.js" as="script"><link rel="preload" href="/vuepressppr/assets/js/29.f12628d0.js" as="script"><link rel="preload" href="/vuepressppr/assets/js/3.5bc5870a.js" as="script"><link rel="prefetch" href="/vuepressppr/assets/js/10.2686d00a.js"><link rel="prefetch" href="/vuepressppr/assets/js/11.fd30b52b.js"><link rel="prefetch" href="/vuepressppr/assets/js/12.fb774cab.js"><link rel="prefetch" href="/vuepressppr/assets/js/13.97058f82.js"><link rel="prefetch" href="/vuepressppr/assets/js/14.77172f79.js"><link rel="prefetch" href="/vuepressppr/assets/js/15.c64e7f5a.js"><link rel="prefetch" href="/vuepressppr/assets/js/16.3be1f0e5.js"><link rel="prefetch" href="/vuepressppr/assets/js/17.f3abe831.js"><link rel="prefetch" href="/vuepressppr/assets/js/18.aa42b649.js"><link rel="prefetch" href="/vuepressppr/assets/js/19.c99e69be.js"><link rel="prefetch" href="/vuepressppr/assets/js/20.d06df924.js"><link rel="prefetch" href="/vuepressppr/assets/js/21.84ee0397.js"><link rel="prefetch" href="/vuepressppr/assets/js/22.516a37df.js"><link rel="prefetch" href="/vuepressppr/assets/js/23.74f1c03e.js"><link rel="prefetch" href="/vuepressppr/assets/js/24.45aab871.js"><link rel="prefetch" href="/vuepressppr/assets/js/25.b79a6340.js"><link rel="prefetch" href="/vuepressppr/assets/js/26.793e594c.js"><link rel="prefetch" href="/vuepressppr/assets/js/27.d7af70d4.js"><link rel="prefetch" href="/vuepressppr/assets/js/28.9bdac829.js"><link rel="prefetch" href="/vuepressppr/assets/js/30.908e2c50.js"><link rel="prefetch" href="/vuepressppr/assets/js/31.f4ebc6d7.js"><link rel="prefetch" href="/vuepressppr/assets/js/32.1ad291b4.js"><link rel="prefetch" href="/vuepressppr/assets/js/33.a15606af.js"><link rel="prefetch" href="/vuepressppr/assets/js/34.ccff6b5b.js"><link rel="prefetch" href="/vuepressppr/assets/js/35.a8474c54.js"><link rel="prefetch" href="/vuepressppr/assets/js/36.8332203f.js"><link rel="prefetch" href="/vuepressppr/assets/js/37.c69b180a.js"><link rel="prefetch" href="/vuepressppr/assets/js/38.cc034efa.js"><link rel="prefetch" href="/vuepressppr/assets/js/4.552a1731.js"><link rel="prefetch" href="/vuepressppr/assets/js/5.2b7133b0.js"><link rel="prefetch" href="/vuepressppr/assets/js/6.28e79f91.js"><link rel="prefetch" href="/vuepressppr/assets/js/7.a41c72a8.js"><link rel="prefetch" href="/vuepressppr/assets/js/8.c3a503dd.js"><link rel="prefetch" href="/vuepressppr/assets/js/9.a4cc5b73.js">
    <link rel="stylesheet" href="/vuepressppr/assets/css/0.styles.47a93a5c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuepressppr/" class="home-link router-link-active"><!----> <span class="site-name">Padr√µes de Projetos</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/leandro-costa/vuepressppr" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/leandro-costa/vuepressppr" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Prototype (GOF) üî®</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vuepressppr/gof/PrototypeRichard/Prototype.html#intencao" class="sidebar-link">Inten√ß√£o</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/PrototypeRichard/Prototype.html#motivacao" class="sidebar-link">Motiva√ß√£o</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/PrototypeRichard/Prototype.html#aplicabilidade" class="sidebar-link">Aplicabilidade</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/PrototypeRichard/Prototype.html#estrutura" class="sidebar-link">Estrutura</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/PrototypeRichard/Prototype.html#participantes" class="sidebar-link">Participantes</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/PrototypeRichard/Prototype.html#colaboracoes" class="sidebar-link">Colabora√ß√µes</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/PrototypeRichard/Prototype.html#consequencias" class="sidebar-link">Consequ√™ncias</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/PrototypeRichard/Prototype.html#implementacao" class="sidebar-link">Implementa√ß√£o</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/PrototypeRichard/Prototype.html#estrutura-do-codigo" class="sidebar-link">Estrutura do C√≥digo</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/PrototypeRichard/Prototype.html#exemplo-de-codigo" class="sidebar-link">Exemplo de c√≥digo</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/PrototypeRichard/Prototype.html#exemplo-de-codigo-livro" class="sidebar-link">Exemplo de c√≥digo Livro</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/PrototypeRichard/Prototype.html#usos-conhecidos" class="sidebar-link">Usos conhecidos</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/PrototypeRichard/Prototype.html#padrao-relacionados" class="sidebar-link">Padr√£o relacionados</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/PrototypeRichard/Prototype.html#referencias" class="sidebar-link">Refer√™ncias</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="prototype-gof-üî®"><a href="#prototype-gof-üî®" class="header-anchor">#</a> Prototype (GOF) üî®</h1> <p>[^GAMMA]</p> <h2 id="intencao"><a href="#intencao" class="header-anchor">#</a> Inten√ß√£o</h2> <p>Especificar os tipos de objetos a serem criados usando uma inst√¢ncia-prot√≥tipo e criar novos objetos pela c√≥pia desse prot√≥tipo.</p> <h2 id="motivacao"><a href="#motivacao" class="header-anchor">#</a> Motiva√ß√£o</h2> <p>Voc√™ poderia construir um editor para partituras musicais customizando um framework geral para editores gr√°ficos, acrescentando novos objetos que representam notas, pausas e pentagramas. O editor do framework pode ter uma paleta de ferramentas para acrescentar esses objetos de m√∫sica √† partitura. A paleta tamb√©m incluiria ferramentas para selecionar, mover e manipular objetos de m√∫sica de outra forma. O usu√°rio clicaria na ferramenta de uma sem√≠nima para adicionar sem√≠nimas √† partitura. Ou poderia usar a ferramenta de movimenta√ß√£o para mover uma nota para cima ou para baixo nas linhas de pauta, desta forma alterando seu registro sonoro.</p> <p>Vamos considerar que o framework forne√ßa uma classe abstrata Graphic para componentes gr√°ficos, como notas e pentagramas. Al√©m disso, fornece uma classe abstrata Tool para definir ferramentas como aquelas da paleta. O framework tamb√©m predefine uma subclasse GraphicTool para ferramentas que criam inst√¢ncias de objetos gr√°ficos e os adicionam ao documento.</p> <p>Mas GraphicTool apresenta um problema para o projetista do framework. As classes para notas e pentagramas s√£o espec√≠ficas da nossa aplica√ß√£o, mas a classe GraphicTool pertence ao framework. GraphicTool n√£o sabe como criar inst√¢ncias das nossas classes musicais para acrescent√°-las √† partitura. Poder√≠amos introduzir sub classes de GraphicTool para cada tipo de objeto musical, mas isso produziria muitas subclasses diferentes somente no tipo de objeto musical que elas instanciam. Sabemos que a composi√ß√£o de objetos √© uma alternativa flex√≠vel para o uso de subclasses. A quest√£o, por√©m, √©, como pode um framework us√°-la para parametrizar inst√¢ncias de GraphicTool pela Classe de Graphic que se espera que elas criem?</p> <p>A solu√ß√£o √© fazer Graph criar um novo Graphic copiando ou &quot;clonando&quot; uma inst√¢ncia de uma subclasse de Graphic. Chamamos esta inst√¢ncia de prot√≥tipo (prototype). A GraphicTool √© parametrizada pelo prot√≥tipo que ela deveria clonar e acrescentar ao documento. Se todas as subclasses de Graphic suportam uma opera√ß√£o Clone, ent√£o GraphicTool pode clonar qualquer tipo de Graphic.</p> <p>Assim, em nosso editor musical, cada ferramenta para criar um objeto musical √© uma inst√¢ncia de GraphicTool que √© iniciada com um prot√≥tipo diferente. Cada inst√¢ncia de GraphicTool produzir√° um objeto musical clonando o seu prot√≥tipo e acrescentando o clone √† partitura.</p> <p><img src="img/motivacao.jpg" alt=""></p> <p>Podemos usar o padr√£o Prototype para reduzir o n√∫mero de classes ainda mais. Temos classes separadas para breves e semibreves, mas isto √© provavelmente desnecess√°rio. Ao inv√©s disso, poderiam ser inst√¢ncias da mesma classe iniciada com diferentes bitmaps e dura√ß√µes. Uma ferramenta para cria√ß√£o de notas do tipo breve torna-se somente uma GraphicTool cujo prot√≥tipo √© uma MusicalNote iniciada como uma breve. Isso pode reduzir o n√∫mero de classes no sistema dramaticamente. Isso tamb√©m torna mais f√°cil acrescentar um novo tipo de nota ao editor musical.</p> <h2 id="aplicabilidade"><a href="#aplicabilidade" class="header-anchor">#</a> Aplicabilidade</h2> <p>Use o padr√£o Prototype quando um sistema tiver que ser independente de como os seus produtos s√£o criados, compostos e representados; e</p> <p>‚Ä¢ quando as classes a instanciar forem especificadas em tempo de execu√ß√£o, por exemplo, por carga din√¢mica; ou</p> <p>‚Ä¢ para evitar a constru√ß√£o de uma hierarquia de classes de f√°bricas paralela √† hierarquia de classes de produto; ou</p> <p>‚Ä¢ quando as inst√¢ncias de uma classe puderem ter uma dentre poucas combina√ß√µes diferentes de estados. Pode ser mais conveniente instalar um n√∫mero correspondente de prot√≥tipos e clon√°-los, ao inv√©s de instanciar a classe manualmente, cada vez com um estado apropriado.</p> <h2 id="estrutura"><a href="#estrutura" class="header-anchor">#</a> Estrutura</h2> <p><img src="img/Estrutura.jpg" alt=""></p> <h2 id="participantes"><a href="#participantes" class="header-anchor">#</a> Participantes</h2> <p>‚Ä¢ Prototype (Graphic)</p> <div class="language- extra-class"><pre><code>‚Äì declara uma interface para clonar a si pr√≥prio.
</code></pre></div><p>‚Ä¢ ConcretePrototype (Staff, Whole Nota, Half Note)</p> <div class="language- extra-class"><pre><code>‚Äì implementa uma opera√ß√£o para clonar a si pr√≥prio.
</code></pre></div><p>‚Ä¢ Client (GraphicTool)</p> <div class="language- extra-class"><pre><code>‚Äì cria um novo objeto solicitando a um prot√≥tipo que clone a si pr√≥prio.
</code></pre></div><h2 id="colaboracoes"><a href="#colaboracoes" class="header-anchor">#</a> Colabora√ß√µes</h2> <p>‚Ä¢ Um cliente solicita a um prot√≥tipo que este clone a si pr√≥prio.</p> <h2 id="consequencias"><a href="#consequencias" class="header-anchor">#</a> Consequ√™ncias</h2> <p>Prototype tem muitas das mesmas consequ√™ncias que Abstract Factory (95) e Builder
(104) t√™m: ele oculta as classes de produtos concretas do cliente, desta forma
reduzindo o n√∫mero de nomes que os clientes necessitam saber. Al√©m disso, esses
padr√µes permitem a um cliente trabalhar com classes espec√≠ficas de uma aplica√ß√£o sem
necessidade de modifica√ß√£o.</p> <p>Os benef√≠cios adicionais do padr√£o Prototype est√£o relacionados abaixo.</p> <ol><li><p>Acrescenta e remove produtos em tempo de execu√ß√£o. Prototype permite incorporar uma nova classe concreta de produto a um sistema, simplesmente registrando uma inst√¢ncia prot√≥tipo com o cliente. Isso √© um pouco mais flex√≠vel do que outros padr√µes de cria√ß√£o, porque o cliente pode instalar e remover prot√≥tipos em tempo de execu√ß√£o.</p></li> <li><p>Especifica novos objetos pela varia√ß√£o de valores. Sistemas altamente din√¢micos permitem definir novos comportamentos atrav√©s da composi√ß√£o de objetos
‚Äì por exemplo, pela especifica√ß√£o de valores para as vari√°veis de um objeto
‚Äì e n√£o pela defini√ß√£o de novas classes.
Voc√™ efetivamente define novos tipos de objetos pela instancia√ß√£o das classes
existentes e registrando as inst√¢ncias como prot√≥tipos dos objetos-clientes.
Um cliente pode exibir um novo comportamento atrav√©s da delega√ß√£o de
responsabilidades para o prot√≥tipo.
Esse tipo de projeto permite aos usu√°rios definir novas ‚Äúclasses‚Äù sem ter que
programar. De fato, clonar um prot√≥tipo √© semelhante a instanciar uma classe.
O padr√£o Prototype pode reduzir grandemente o n√∫mero de classes que um
sistema necessita. No nosso editor musical, uma classe GraphicTool pode criar
uma variedade ilimitada de objetos musicais.</p></li> <li><p>Especifica novos objetos pela varia√ß√£o da estrutura. Muitas aplica√ß√µes constroem
objetos com partes e subpartes. Por exemplo, editores para o projeto de
circuitos que constroem circuitos a partir de sub circuitos.1 Por quest√µes de
conveni√™ncia, tais aplica√ß√µes frequentemente permitem instanciar estruturas complexas, definidas pelo usu√°rio, para, por exemplo, usar um sub circuito
espec√≠fico repetidas vezes.
O padr√£o Prototype tamb√©m suporta isso. Simplesmente adicionamos esse
sub circuito como um prot√≥tipo √† paleta dos elementos de circuitos dispon√≠veis. Contanto que o objeto-circuito composto implemente um clone por
replica√ß√£o (deep copy), circuitos com diferentes estruturas podem ser prot√≥tipos.</p></li> <li><p>Reduz o n√∫mero de subclasses. O Factory Method (112) frequentemente produz
uma hierarquia de classes Creator paralela √† hierarquia de classes do
produto. O padr√£o Prototype permite clonar um prot√≥tipo em vez de pedir a um
m√©todo f√°brica para construir um novo objeto. Da√≠ n√£o necessitar-se de
nenhuma hierarquia de classes Creator. Esse benef√≠cio se aplica primariamente a linguagens como C++, que n√£o tratam as classes como objetos de primeira
classe. As linguagens que assim o fazem, como Smalltalk e Objective C, obt√™m
menos benef√≠cios, uma vez que sempre se usa um objeto-classe como um
criador. Objetos-classe j√° funcionam como prot√≥tipos nessas linguagens.</p></li> <li><p>Configura dinamicamente uma aplica√ß√£o com classes. Alguns ambientes de tempo
de execu√ß√£o permitem carregar classes dinamicamente numa aplica√ß√£o. O
padr√£o Prototype √© a chave para a explora√ß√£o de tais possibilidades numa
linguagem como C++.
Uma aplica√ß√£o que quer criar inst√¢ncias de uma classe dinamicamente
carregada n√£o ser√° capaz de referenciar o seu constructor estaticamente. Em
vez disso, o ambiente de tempo de execu√ß√£o cria uma inst√¢ncia de cada classe
automaticamente, quando carregada, e registra a inst√¢ncia junto a um
gerenciador de prot√≥tipo (ver a se√ß√£o Implementa√ß√£o). Ent√£o, a aplica√ß√£o
pode solicitar ao gerenciador de prot√≥tipos inst√¢ncias de classes rec√©m carregadas, classes essas que originalmente n√£o estavam ‚Äúlinkadas‚Äù ao
programa. O framework de aplica√ß√µes da ET++ [WGM88] tem um sistema de
tempo de execu√ß√£o que usa este esquema.</p></li></ol> <p>O principal ponto fraco do padr√£o Prototype √© que cada subclasse de Prototype
deve implementar a opera√ß√£o Clone, o que pode ser dif√≠cil. Por exemplo, acrescentar
Clone √© dif√≠cil quando as classes consideradas j√° existem. A implementa√ß√£o de Clone
pode ser complicada quando uma estrutura interna dessas classes inclui objetos que
n√£o suportam opera√ß√£o de c√≥pia ou t√™m refer√™ncias circulares.</p> <h2 id="implementacao"><a href="#implementacao" class="header-anchor">#</a> Implementa√ß√£o</h2> <p>Prototype √© particularmente √∫til com linguagens est√°ticas como C++, na qual as classes n√£o s√£o objetos, e pouca ou nenhuma informa√ß√£o sobre tipos est√° dispon√≠vel em tempo de execu√ß√£o. Ele √© menos importante em linguagens como Smalltalk ou Objective C, que
fornecem o equivalente a um prot√≥tipo (ou seja, um objeto-classe) para cria√ß√£o de
inst√¢ncias de cada classe. Este padr√£o est√° incorporado em linguagens baseadas em
prot√≥tipos como a Self [US87], na qual toda a cria√ß√£o de objetos se d√° pela clonagem de
um prot√≥tipo.</p> <p>Ao implementar prot√≥tipos levam-se em considera√ß√£o os seguintes aspectos:</p> <ol><li><p>Usar um gerenciador de prot√≥tipos. Quando o n√∫mero de prot√≥tipos num sistema
n√£o √© fixo (ou seja, eles podem ser criados e destru√≠dos dinamicamente), √©
importante manter um sistema de registro dos prot√≥tipos dispon√≠veis. Os
clientes n√£o v√£o gerenciar os prot√≥tipos, mas far√£o sua armazenagem e
recupera√ß√£o pelo sistema de registro. Um cliente solicitar√° um prot√≥tipo ao
sistema de registro antes de clon√°-lo. N√≥s chamamos esse sistema de registro
de gerenciador de prot√≥tipos.
Um gerenciador de prot√≥tipos √© uma mem√≥ria associativa que retorna o
prot√≥tipo correspondente a uma chave fornecida. Ele tem opera√ß√µes para
registrar um prot√≥tipo com uma chave e para remov√™-lo do registro. Os
clientes podem mudar ou mesmo pesquisar o registro em tempo de execu√ß√£o. Isso permite aos clientes estenderem e fazerem um invent√°rio do sistema
sem necessidade de escrever linhas de c√≥digo.</p></li> <li><p>Implementar a opera√ß√£o Clone. A parte mais dif√≠cil do padr√£o Prototype √© a
implementa√ß√£o correta da opera√ß√£o Clone. Ela √© particularmente dif√≠cil
quando as estruturas de objetos cont√™m refer√™ncias circulares.
A maioria das linguagens fornece algum suporte para clonagem de objetos. Por
exemplo, Smalltalk fornece uma implementa√ß√£o de copy que √© herdada por
todas as subclasses de Object. C++ fornece um constructor copy. Mas estes
recursos n√£o resolvem o problema shallow copy versus deep copy (c√≥pia por
refer√™ncia versus c√≥pia por replica√ß√£o) [GR83]. Ou seja, clonar objetos significa
clonar suas vari√°veis de inst√¢ncia, ou o clone e o original simplesmente
compartilham as vari√°veis?
Uma shallow copy √© simples e, na maior parte das vezes, suficiente, e √© o que o
Smalltalk fornece por omiss√£o. O constructor de c√≥pias por omiss√£o em C++
faz uma c√≥pia membro a membro, o que significa que os apontadores ser√£o
compartilhados entre a c√≥pia e o original. Por√©m, clonar prot√≥tipos com
estruturas complexas normalmente exige uma c√≥pia por replica√ß√£o (deep copy),
porque o clone e o original devem ser independentes. Portanto, voc√™ deve
garantir que os componentes do clone s√£o clones dos componentes do prot√≥tipo. A clonagem for√ßa a decidir o que, se for o caso, ser√° compartilhado.
Se os objetos no sistema fornecem opera√ß√µes de Salvar e Carregar, ent√£o voc√™
pode us√°-las para fornecer uma implementa√ß√£o por omiss√£o de Clone
simplesmente salvando o objeto e carregando-o de volta imediatamente. A
opera√ß√£o Salvar salva o objeto num buffer de mem√≥ria, e a opera√ß√£o Carregar
cria uma c√≥pia por reconstru√ß√£o do objeto a partir do buffer.</p></li> <li><p>Iniciar clones. Enquanto alguns clientes ficam perfeitamente contentes com o
clone tal como ele √©, outros desejar√£o iniciar alguns ou todos os seus estados
internos com valores de sua escolha.
Voc√™ geralmente n√£o pode passar esses valores para opera√ß√£o Clone porque
o seu n√∫mero variar√° entre as classes de prot√≥tipo. Alguns prot√≥tipos podem
necessitar de m√∫ltiplos par√¢metros de inicializa√ß√£o; outros n√£o necessitar√£o de nenhum. Passar par√¢metros para a opera√ß√£o Clone impede uma interface
uniforme de clonagem.
Pode ser que suas classes-prot√≥tipo j√° definam opera√ß√µes para (re)estabelecer
estados-chave. Caso isso aconte√ßa, os clientes podem usar essas opera√ß√µes
imediatamente ap√≥s a clonagem. Se isso n√£o acontecer, ent√£o voc√™ pode ter que
introduzir uma opera√ß√£o Initialize(ver a se√ß√£o de Exemplo de C√≥digo) que
recebe par√¢metros de inicializa√ß√£o como argumentos e estabelece o estado
interno do clone de acordo. Cuidado com as opera√ß√µes clone que usam
replica√ß√£o (deep copying) ‚Äì as c√≥pias podem ter que ser deletadas (ou explicitamente, ou dentro de Initialize) antes de voc√™ reinicializ√°-la</p></li></ol> <h2 id="estrutura-do-codigo"><a href="#estrutura-do-codigo" class="header-anchor">#</a> Estrutura do C√≥digo</h2> <figure><div class="language-plantuml line-numbers-mode"><pre class="language-text"><code>
@startuml
     
     abstract class Shape{
        +int x
        +int y
        +String color

        {abstract} Shape clone()
    }

    class Circle extends Shape{
        +int radius

        +Shape clone()
    } 

    class Rectangle extends Shape{
        +int width
        +int height

        +Shape clone()
    }

    

    @enduml

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><figcaption>Estrutura do C√≥digo Prototype.</figcaption></figure> <h2 id="exemplo-de-codigo"><a href="#exemplo-de-codigo" class="header-anchor">#</a> Exemplo de c√≥digo</h2> <p>shapes: Lista de formas</p> <p>shapes/Shape.java: Interface comum de forma</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Objects</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Shape</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> x<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> y<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> color<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Shape</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Shape</span><span class="token punctuation">(</span><span class="token class-name">Shape</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>target <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> target<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">=</span> target<span class="token punctuation">.</span>y<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>color <span class="token operator">=</span> target<span class="token punctuation">.</span>color<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token class-name">Shape</span> <span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span> object2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>object2 <span class="token keyword">instanceof</span> <span class="token class-name">Shape</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token class-name">Shape</span> shape2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Shape</span><span class="token punctuation">)</span> object2<span class="token punctuation">;</span>
        <span class="token keyword">return</span> shape2<span class="token punctuation">.</span>x <span class="token operator">==</span> x <span class="token operator">&amp;&amp;</span> shape2<span class="token punctuation">.</span>y <span class="token operator">==</span> y <span class="token operator">&amp;&amp;</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>shape2<span class="token punctuation">.</span>color<span class="token punctuation">,</span> color<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>shapes/Circle.java: Form simples</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Circle</span> <span class="token keyword">extends</span> <span class="token class-name">Shape</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> radius<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Circle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Circle</span><span class="token punctuation">(</span><span class="token class-name">Circle</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>target <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>radius <span class="token operator">=</span> target<span class="token punctuation">.</span>radius<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Shape</span> <span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Circle</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span> object2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>object2 <span class="token keyword">instanceof</span> <span class="token class-name">Circle</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>object2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token class-name">Circle</span> shape2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Circle</span><span class="token punctuation">)</span> object2<span class="token punctuation">;</span>
        <span class="token keyword">return</span> shape2<span class="token punctuation">.</span>radius <span class="token operator">==</span> radius<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>shapes/Rectangle.java: Outra forma</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Rectangle</span> <span class="token keyword">extends</span> <span class="token class-name">Shape</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> width<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> height<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Rectangle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Rectangle</span><span class="token punctuation">(</span><span class="token class-name">Rectangle</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>target <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>width <span class="token operator">=</span> target<span class="token punctuation">.</span>width<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>height <span class="token operator">=</span> target<span class="token punctuation">.</span>height<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Shape</span> <span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Rectangle</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span> object2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>object2 <span class="token keyword">instanceof</span> <span class="token class-name">Rectangle</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>object2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token class-name">Rectangle</span> shape2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Rectangle</span><span class="token punctuation">)</span> object2<span class="token punctuation">;</span>
        <span class="token keyword">return</span> shape2<span class="token punctuation">.</span>width <span class="token operator">==</span> width <span class="token operator">&amp;&amp;</span> shape2<span class="token punctuation">.</span>height <span class="token operator">==</span> height<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>Demo.java: Exemplo de clonagem</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token namespace">refactoring_guru<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>example<span class="token punctuation">.</span>shapes<span class="token punctuation">.</span></span><span class="token class-name">Circle</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">refactoring_guru<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>example<span class="token punctuation">.</span>shapes<span class="token punctuation">.</span></span><span class="token class-name">Rectangle</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">refactoring_guru<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>example<span class="token punctuation">.</span>shapes<span class="token punctuation">.</span></span><span class="token class-name">Shape</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Shape</span><span class="token punctuation">&gt;</span></span> shapes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Shape</span><span class="token punctuation">&gt;</span></span> shapesCopy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Circle</span> circle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Circle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        circle<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
        circle<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
        circle<span class="token punctuation">.</span>radius <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">;</span>
        circle<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">&quot;red&quot;</span><span class="token punctuation">;</span>
        shapes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>circle<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Circle</span> anotherCircle <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Circle</span><span class="token punctuation">)</span> circle<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        shapes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>anotherCircle<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Rectangle</span> rectangle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Rectangle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        rectangle<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
        rectangle<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
        rectangle<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">&quot;blue&quot;</span><span class="token punctuation">;</span>
        shapes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>rectangle<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">cloneAndCompare</span><span class="token punctuation">(</span>shapes<span class="token punctuation">,</span> shapesCopy<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">cloneAndCompare</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Shape</span><span class="token punctuation">&gt;</span></span> shapes<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Shape</span><span class="token punctuation">&gt;</span></span> shapesCopy<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Shape</span> shape <span class="token operator">:</span> shapes<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            shapesCopy<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>shape<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> shapes<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>shapes<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">!=</span> shapesCopy<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token string">&quot;: Shapes are different objects (yay!)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>shapes<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>shapesCopy<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token string">&quot;: And they are identical (yay!)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token string">&quot;: But they are not identical (booo!)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token string">&quot;: Shape objects are the same (booo!)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br></div></div><p>OutputDemo.txt: Resultados da execu√ß√£o</p> <div class="language-JAVA line-numbers-mode"><pre class="language-java"><code><span class="token number">0</span><span class="token operator">:</span> <span class="token class-name">Shapes</span> are different objects <span class="token punctuation">(</span>yay<span class="token operator">!</span><span class="token punctuation">)</span>
<span class="token number">0</span><span class="token operator">:</span> <span class="token class-name">And</span> they are identical <span class="token punctuation">(</span>yay<span class="token operator">!</span><span class="token punctuation">)</span>
<span class="token number">1</span><span class="token operator">:</span> <span class="token class-name">Shapes</span> are different objects <span class="token punctuation">(</span>yay<span class="token operator">!</span><span class="token punctuation">)</span>
<span class="token number">1</span><span class="token operator">:</span> <span class="token class-name">And</span> they are identical <span class="token punctuation">(</span>yay<span class="token operator">!</span><span class="token punctuation">)</span>
<span class="token number">2</span><span class="token operator">:</span> <span class="token class-name">Shapes</span> are different objects <span class="token punctuation">(</span>yay<span class="token operator">!</span><span class="token punctuation">)</span>
<span class="token number">2</span><span class="token operator">:</span> <span class="token class-name">And</span> they are identical <span class="token punctuation">(</span>yay<span class="token operator">!</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="exemplo-de-codigo-livro"><a href="#exemplo-de-codigo-livro" class="header-anchor">#</a> Exemplo de c√≥digo Livro</h2> <p>Definiremos uma subclasse MazePrototypeFactory da classe MazeFactory (p√°gina
100). MazePrototypeFactory ser√° iniciada com prot√≥tipos dos objetos que criar√°, de
maneira que n√£o tenhamos que criar subclasses somente para mudar as classes de
paredes ou salas que ela cria.</p> <p>A MazePrototypeFactory aumenta a interface de Maze Factory com um constructor que aceita os prot√≥tipos como argumentos:</p> <p><img src="img/Ex_cod_1.jpg" alt=""></p> <p>As fun√ß√µes-membro para a cria√ß√£o de paredes, salas e portas s√£o semelhantes:
cada uma clona um prot√≥tipo e ent√£o o inicia. Aqui est√£o as defini√ß√µes de MakeWall e MakeDoor:</p> <p><img src="img/Ex_cod_2.jpg" alt=""></p> <p>Podemos usar MazePrototypeFactory para criar um labirinto-prot√≥tipo (ou um
labirinto por omiss√£o) simplesmente iniciando-o com prot√≥tipos dos componentes
b√°sicos de labirinto:</p> <p><img src="img/Ex_cod_3.jpg" alt=""></p> <p>Para mudar o tipo de labirinto, iniciamos MazePrototypeFactory com um
conjunto diferente de prot√≥tipos. A seguinte chamada cria um labirinto com uma
BombedDoor e um RoomWithABomb:</p> <p><img src="img/Ex_cod_4.jpg" alt=""></p> <p>Um objeto que pode ser usado como um prot√≥tipo, tal como uma inst√¢ncia de
Wall, deve suportar a opera√ß√£o Clone. Ele tamb√©m deve ter um constructor de c√≥pias
para fazer a clonagem. Tamb√©m pode necessitar de uma opera√ß√£o separada para a
reinicializa√ß√£o do estado interno. Acrescentaremos a opera√ß√£o Initialize √† Door
para permitir aos clientes inicializarem as salas do clone.
Compare a seguinte defini√ß√£o de Door com da p√°gina 93</p> <p><img src="img/Ex_cod_5.jpg" alt=""></p> <p><img src="img/Ex_cod_6.jpg" alt=""></p> <p>A subclasse BombedWall deve redefinir Clone e implementar um constructor de
c√≥pias correspondente.</p> <p><img src="img/Ex_cod_7.jpg" alt=""></p> <p>Embora BombedWall::Clone retorne um Wall*, sua implementa√ß√£o retorna
um ponteiro para uma nova inst√¢ncia de uma subclasse, qual seja, um BombedWall*.
Definimos Clone desta maneira na classe-base para nos assegurarmos de que os
clientes que clonam o prot√≥tipo n√£o tenham que conhecer suas subclasses concretas.
Clientes nunca deveriam precisar fazer um downcast do valor de retorno de Clone
para o tipo desejado.
Em Smalltalk, voc√™ pode reutilizar o m√©todo-padr√£o copy herdado de Object
para clonar qualquer MapSite. Voc√™ pode usar MazeFactory para produzir os
prot√≥tipos de que necessita; por exemplo, pode criar uma sala fornecendo o nome
#room.
A MazeFactory (f√°brica de labirintos) tem um dicion√°rio que mapeia nomes aos
prot√≥tipos. Seu m√©todo make: se parece com o seguinte:</p> <p><img src="img/Ex_cod_8.jpg" alt=""></p> <p>Tendo m√©todos apropriados para inicia a MazeFactory com prot√≥tipos, voc√™
poderia criar um labirinto simples com o seguinte c√≥digo:</p> <p><img src="img/Ex_cod_9.jpg" alt=""></p> <p>onde a defini√ß√£o do m√©todo de classe on: para CreateMaze seria</p> <p><img src="img/Ex_cod_10.jpg" alt=""></p> <h2 id="usos-conhecidos"><a href="#usos-conhecidos" class="header-anchor">#</a> Usos conhecidos</h2> <p>Talvez o primeiro exemplo do padr√£o Prototype se encontre no sistema Sketchpad de Ivan Sutherland [Sut63]. A primeira aplica√ß√£o amplamente conhecida do padr√£o numa linguagem orientada a objeto foi em ThingLab, na qual os usu√°rios poderiam formar um objeto composto e ent√£o promov√™-lo a um prot√≥tipo pela sua instala√ß√£o numa
biblioteca de objetos reutiliz√°veis [Bor81]. Goldberg e Robson mencionam prot√≥tipos como um padr√£o [GR83], mas Coplien [Cop92] fornece uma descri√ß√£o muito mais completa. Ele descreve idiomas relacionados ao padr√£o prototype para C++ e d√° muitos exemplos e varia√ß√µes.</p> <p>O Etgdb √© um depurador (debugger) de front-end, baseado em ET++, que fornece
uma interface de apontar e clicar para diferentes depuradores orientados a linhas.
Cada depurador tem uma subclasse DebuggerAdaptor correspondente. Por exemplo, GdbAdaptor adapta o etgdb √† sintaxe dos comandos do gdb de GNU, enquanto que SunDbxAdaptor adapta o etgdb ao depurador da Sun. O Etgdb n√£o tem um conjunto de classes DebuggerAdaptor codificadas rigidamente nele pr√≥prio. Em vez disso, l√™ o nome do adaptor a ser usado de uma vari√°vel fornecida pelo ambiente,
procura um prot√≥tipo com o nome especificado em uma tabela global e, ent√£o, clona o prot√≥tipo. Novos depuradores podem ser acrescentados ao etgdb ligando-o ao DebuggerAdaptor que funciona para um depurador novo.</p> <p>A ‚Äúbiblioteca de t√©cnicas de intera√ß√µes‚Äù, no ModeComposer, armazena prot√≥tipos de objetos que suportam v√°rias t√©cnicas de intera√ß√£o [Sha90]. Qualquer t√©cnica
de intera√ß√£o criada pelo Mode Composer pode ser usada como um prot√≥tipo
colocando-a nesta biblioteca. O padr√£o Prototype permite ao Mode Composer suportar um conjunto ilimitado de t√©cnicas de intera√ß√£o.</p> <p>O exemplo do editor musical discutido anteriormente se baseia no framework
para desenhos do Unidraw [VL90].</p> <h2 id="padrao-relacionados"><a href="#padrao-relacionados" class="header-anchor">#</a> Padr√£o relacionados</h2> <p>Prototype e Abstract Factory (95) s√£o padr√µes que competem entre si em v√°rias situa√ß√µes, como discutimos no final deste cap√≠tulo. Por√©m, eles tamb√©m podem ser usados em conjunto. Um Abstract Factory pode armazenar um conjunto de prot√≥tipos a partir dos quais podem ser clonados e retornados objetos-produto.</p> <p>Projetos que utilizam intensamente os padr√µes Composite (160) e Decorator (170)
tamb√©m podem se beneficiar do uso do Prototype.</p> <h2 id="referencias"><a href="#referencias" class="header-anchor">#</a> Refer√™ncias</h2> <p>PROTOTYPE: Cria√ß√£o de Objetos. In: GAMMA, ERICH; HELM, RICHARD; JOHNSON, RALPH; VLISSIDES, JOHN. Padr√µes de Projeto: Solu√ß√µes reutiliz√°veis de software orientado a objetos. [S. l.: s. n.], 2000.</p> <p>REFACTORING.GURU. Prototype em Java. [S. l.], 3 abr. 2022. Dispon√≠vel em: https://refactoring.guru/pt-br/design-patterns/prototype/java/example. Acesso em: 7 abr. 2022.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/leandro-costa/vuepressppr/edit/master/src/gof/PrototypeRichard/Prototype.md" target="_blank" rel="noopener noreferrer">Edit!</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">4/29/2022, 12:29:43 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ‚Üê
      <a href="/vuepressppr/03_GOF.html" class="prev">
        GOF üî®
      </a></span> <!----></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/vuepressppr/assets/js/app.c089e0e7.js" defer></script><script src="/vuepressppr/assets/js/2.63c38da0.js" defer></script><script src="/vuepressppr/assets/js/29.f12628d0.js" defer></script><script src="/vuepressppr/assets/js/3.5bc5870a.js" defer></script>
  </body>
</html>
