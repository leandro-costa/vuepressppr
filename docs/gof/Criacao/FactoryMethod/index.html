<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Factory Method (GOF) ✅ | Padrões de Projetos</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css">
    <link rel="icon" href="/vuepressppr/logo.png">
    <link rel="manifest" href="/vuepressppr/manifest.json">
    <link rel="apple-touch-icon" href="/vuepressppr/icon-192x192.png">
    <link rel="mask-icon" href="/vuepressppr/icon-192x192.png" color="#3eaf7c">
    <meta name="description" content="Material para as aulas da disciplina de Padrões de Projetos">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icon-192x192.png">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/vuepressppr/assets/css/0.styles.47a93a5c.css" as="style"><link rel="preload" href="/vuepressppr/assets/js/app.5f32d716.js" as="script"><link rel="preload" href="/vuepressppr/assets/js/2.63c38da0.js" as="script"><link rel="preload" href="/vuepressppr/assets/js/22.590de762.js" as="script"><link rel="preload" href="/vuepressppr/assets/js/3.5bc5870a.js" as="script"><link rel="prefetch" href="/vuepressppr/assets/js/10.2686d00a.js"><link rel="prefetch" href="/vuepressppr/assets/js/11.a34fa059.js"><link rel="prefetch" href="/vuepressppr/assets/js/12.3633f32f.js"><link rel="prefetch" href="/vuepressppr/assets/js/13.31e4f6cd.js"><link rel="prefetch" href="/vuepressppr/assets/js/14.9c37828a.js"><link rel="prefetch" href="/vuepressppr/assets/js/15.a728bf44.js"><link rel="prefetch" href="/vuepressppr/assets/js/16.991802d3.js"><link rel="prefetch" href="/vuepressppr/assets/js/17.e7691df1.js"><link rel="prefetch" href="/vuepressppr/assets/js/18.98381aae.js"><link rel="prefetch" href="/vuepressppr/assets/js/19.4abd142b.js"><link rel="prefetch" href="/vuepressppr/assets/js/20.c4e9abb8.js"><link rel="prefetch" href="/vuepressppr/assets/js/21.1ea42746.js"><link rel="prefetch" href="/vuepressppr/assets/js/23.1aac4d31.js"><link rel="prefetch" href="/vuepressppr/assets/js/24.127dd2bd.js"><link rel="prefetch" href="/vuepressppr/assets/js/25.29d15064.js"><link rel="prefetch" href="/vuepressppr/assets/js/26.a8072170.js"><link rel="prefetch" href="/vuepressppr/assets/js/27.04fd3c24.js"><link rel="prefetch" href="/vuepressppr/assets/js/28.fa87c2b8.js"><link rel="prefetch" href="/vuepressppr/assets/js/29.c3ae10b4.js"><link rel="prefetch" href="/vuepressppr/assets/js/4.97fbe56c.js"><link rel="prefetch" href="/vuepressppr/assets/js/5.2b7133b0.js"><link rel="prefetch" href="/vuepressppr/assets/js/6.28e79f91.js"><link rel="prefetch" href="/vuepressppr/assets/js/7.a41c72a8.js"><link rel="prefetch" href="/vuepressppr/assets/js/8.c3a503dd.js"><link rel="prefetch" href="/vuepressppr/assets/js/9.4e94b1fd.js">
    <link rel="stylesheet" href="/vuepressppr/assets/css/0.styles.47a93a5c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuepressppr/" class="home-link router-link-active"><!----> <span class="site-name">Padrões de Projetos</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/leandro-costa/vuepressppr" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/leandro-costa/vuepressppr" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Factory Method (GOF) ✅</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vuepressppr/gof/Criacao/FactoryMethod/#intencao" class="sidebar-link">Intenção</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/Criacao/FactoryMethod/#tambem-conhecido-como" class="sidebar-link">Também conhecido como</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/Criacao/FactoryMethod/#motivacao" class="sidebar-link">Motivação</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/Criacao/FactoryMethod/#aplicabilidade" class="sidebar-link">Aplicabilidade</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/Criacao/FactoryMethod/#estrutura" class="sidebar-link">Estrutura</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/Criacao/FactoryMethod/#participantes" class="sidebar-link">Participantes</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/Criacao/FactoryMethod/#colaboracoes" class="sidebar-link">Colaborações</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/Criacao/FactoryMethod/#consequencias" class="sidebar-link">Consequências</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/Criacao/FactoryMethod/#implementacao" class="sidebar-link">Implementação</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/Criacao/FactoryMethod/#exemplo-de-codigo" class="sidebar-link">Exemplo de código</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/Criacao/FactoryMethod/#usos-conhecidos" class="sidebar-link">Usos conhecidos</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/Criacao/FactoryMethod/#padrao-relacionados" class="sidebar-link">Padrão relacionados</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepressppr/gof/Criacao/FactoryMethod/#referencias" class="sidebar-link">Referências</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="factory-method-gof-✅"><a href="#factory-method-gof-✅" class="header-anchor">#</a> Factory Method (GOF) ✅</h1> <p><sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup></p> <h2 id="intencao"><a href="#intencao" class="header-anchor">#</a> Intenção</h2> <p>Definir uma interface para criar um objeto, mas deixar as subclasses decidirem que classe instanciar. O Factory Method permite adiar a instanciação para subclasses.</p> <h2 id="tambem-conhecido-como"><a href="#tambem-conhecido-como" class="header-anchor">#</a> Também conhecido como</h2> <p>Virtual Constructor</p> <h2 id="motivacao"><a href="#motivacao" class="header-anchor">#</a> Motivação</h2> <p>Os frameworks usam classes abstratas para definir e manter relacionamentos entre objetos. Um framework é freqüentemente responsável também pela criação desses objetos.</p> <p>Considere um framework para aplicações que podem apresentar múltiplos documentos para o usuário. Duas abstrações-chave nesse framework são as classes Application (aplicação) e Document (documento). As duas classes são abstratas, e os clientes devem prover subclasses para realizar suas implementações específicas para a aplicação. Por exemplo, para criar uma aplicação de desenho, definimos as classes DrawingApplication e DrawingDocument. A classe Application é responsável pela administração de Documents e irá criá-los conforme exigido — quando o usuário seleciona Open (abrir) ou New (novo), por exemplo, num menu.</p> <p>Uma vez que a subclasse Document a ser instanciada é própria da aplicação específica, a classe Application não pode prever a subclasse de Document a ser instanciada — a classe Application somente sabe quando um documento deve ser criado, e não que tipo de Document criar. Isso cria um dilema: o framework deve instanciar classes, mas ele somente tem conhecimento de classes abstratas, as quais não pode instanciar.</p> <p>O padrão Factory Method oferece uma solução. Ele encapsula o conhecimento sobre a subclasse de Document que deve ser criada e move este conhecimento para fora do framework.</p> <figure><img src="https://www.plantuml.com/plantuml/svg/PPBDRi8m383lVWeVuL0Ue329IRlo424nQwGsgM8NL37UVSaWNHfwSh_Kdt_I8uiACWqzg3DBK5fGzuePlxoU1d9o1upFFPy-q8_aDjkQwjuplJ2hQmu3NIb8V7b0NU1p77khbLZltcheG4eej_1oERfL9BLIe5ZZgJxDR_BQc5XAo0GRNtQ4s1gl6Kfq-6cQjHhXD2-2GtNuhywP2m1mNWY3_Uu4_MMTrxRhNX7I6cKABcsWqCI9oHbCgbguqXLxIwubZWFYnv-pNiu-VfR6tobZDZ78OFUy-trHjxE6a8PHPbGYmPud8IxfGD9vmm37c1J_iry0" alt="uml diagram"> <figcaption>Exemplo factory Method.</figcaption></figure> <p>As subclasses de <code>Application</code> redefinem uma operação abstrata <code>createDocument</code> em <code>Application</code> para retornar a subclasse apropriada de <code>Document.</code> Uma vez que uma subclasse de <code>Application</code> é instanciada, pode então instanciar <code>Documents</code> específicos da aplicação sem conhecer suas classes. Chamamos <code>createDocument</code> um <strong>factory method</strong> porque ele é responsável pela &quot;manufatura&quot; de um objeto.</p> <h2 id="aplicabilidade"><a href="#aplicabilidade" class="header-anchor">#</a> Aplicabilidade</h2> <p>Use o padrão Factory Method quando:</p> <ul><li>uma classe não pode antecipar a classe de objetos que deve criam;</li> <li>uma classe quer que suas subclasses especifiquem os objetos que criam;</li> <li>classes delegam responsabilidade para uma dentre várias subclasses auxiliares, e você quer o conhecimento de qual subclasse auxiliar que é a delegada.</li></ul> <h2 id="estrutura"><a href="#estrutura" class="header-anchor">#</a> Estrutura</h2> <figure><img src="https://www.plantuml.com/plantuml/svg/PP71Ri8m38RlVWeVnu4-GCSaf9sdxHLCQjP8DAaSHmXrl3i6fHqDEVZm_xy_sSu-AOdcuGHqI2ha5Ds9Ki8VYLrsEi4LQkjJc3JA16Xlciqh7gr6kNonzh5xspni2jyZ2wcFmHHZ5KGCJbXvXQhxBLrytFrjjtKJmYoKMN7tcccTU88bqE1YvFIlh_cp2X2YCeh_xHNZiMQtxMfWj1tCpH8myBc6sJeSEhm3Nx0pxkbMTrZJD5R7Cin7VPxt4bcmlUyOUHZrWgGg_f2LqxCwF3eJmDvwxCjl" alt="uml diagram"> <figcaption>Estrutura Factory Method.</figcaption></figure> <h2 id="participantes"><a href="#participantes" class="header-anchor">#</a> Participantes</h2> <ul><li><strong>Product</strong> (Document)
<ul><li>define a interface de objetos que o <code>factoryMethod</code> cria.</li></ul></li> <li><strong>ConcreteProduct</strong> (MyDocument)
<ul><li>implementa a interface de <code>Product</code>.</li></ul></li> <li><strong>Creator</strong> (Application)
<ul><li>Declara o <code>factoryMethod</code>, o qual retorna um objeto do tipo <code>Product</code>. <code>Creator</code> pode também definir uma implementação por omissão do <code>factoryMethod</code> que retorna por omissão um objeto <code>ConcreteProduct</code>.</li> <li>Pode chamar o <code>factoryMethod</code> para criar um objeto <code>Product.</code></li></ul></li> <li><strong>ConcreteCreator</strong> (MyApplication)
<ul><li>Redefine o <code>factoryMethod</code> para retornar a uma instância de um
<code>ConcreteProduct.</code></li></ul></li></ul> <h2 id="colaboracoes"><a href="#colaboracoes" class="header-anchor">#</a> Colaborações</h2> <ul><li>Creator depende das suas subclasses para definir o método de fábrica de maneira que retorne uma instância do ConcreteProduct apropriado.</li></ul> <h2 id="consequencias"><a href="#consequencias" class="header-anchor">#</a> Consequências</h2> <p>Os Factory Methods eliminam a necessidade de anexar classes específicas das aplicações no código. O código lida somente com a interface de <code>Product</code>; portanto, ele pode trabalhar com quaisquer classes <code>ConcreteProduct</code> definidas pelo usuário.</p> <p>Uma desvantagem em potencial dos Factory Methods é que os clientes podem ter que fornecer subclasses da classe <code>Creator</code> somente para criar um objeto <code>ConcreteProduct</code> em particular. Usar subclasses é bom quando o cliente tem que fornecer subclasses a <code>Creator</code> de qualquer maneira, caso contrário, o cliente deve lidar com outro ponto de evolução.</p> <p>Apresentamos aqui duas consequências adicionais do Factory Method:</p> <ol><li><p>Fornece ganchos para subclasses. Criar objetos dentro de uma classe com um método de fábrica é sempre mais flexível do que criar um objeto diretamente. Factory Method dá às subclasses um gancho para fornecer uma versão estendida de um objeto. No exemplo de Documentos, a classe <code>Document</code> poderia definir um Factory Method chamado <code>createFileDialog</code> que cria um objeto file dialog por omissão para abrir um documento existente. Uma de <code>Document</code> pode definir um <code>fileDialog</code> específico da aplicação redefinindo este método de fábrica. Neste caso, o método de fábrica não é abstrato, mas fornece uma implementação por omissão razoável.</p></li> <li><p>Conecta hierarquias de classe paralelas. Nos exemplos que consideramos até aqui o Factory Method é somente chamado por <code>Creators</code>. Mas isto não precisa ser obrigatoriamente assim; os clientes podem achar os Factory Methods úteis, especialmente no caso de hierarquias de classe paralelas. Hierarquias de classe paralelas ocorrem quando uma classe delega alguma das suas responsabilidades para uma classe separada. Considere, por exemplo, figuras que podem ser manipuladas interativamente; ou seja, podem ser esticadas, movidas ou giradas usando o mouse. Implementar tais interações não é sempre fácil. Isso frequentemente requer armazenar e atualizar informação que registra o estado da manipulação num certo momento. Este estado é necessário somente durante a manipulação; portanto, não necessita ser mantido no objeto-figura. Além do mais, diferentes figuras se comportam de modo diferente quando são manipuladas pelo usuário. Por exemplo, esticar uma linha pode ter o efeito de mover um dos extremos, enquanto que esticar um texto pode mudar o seu espaçamento de linhas.
Com essas restrições, é melhor usar um objeto <code>Manipulator</code> separado, que implementa a interação e mantém o registro de qualquer estado específico da manipulação que for necessário. Diferentes figuras utilizarão diferentes subclasses <code>Manipulator</code> para tratar interações específicas. A hierarquia de classes <code>Manipulator</code> resultante é paralela (ao menos parcialmente) à hierarquia de classes de <code>Figure</code>:</p></li></ol> <figure><img src="https://www.plantuml.com/plantuml/svg/dPB12i8m38RlUOeSzJ2VG8OWUDARBv1jOHQtRhGfAdFlxcHAkrL4tANmvy_tD-asLiY8gokWp8gXN32lo5hSgT8PxW27htlNUimDa_21j6fTHTAOnH9wWB5dhpI7VL_DHxxA3-RHWkjxaWJyYUn90FCn0buqIz5SzBPI-Nb8cfSCbR7gshTzCdAKCGS7j0-8v_N_HWIDVaU161jcSNx32GvSriBmEZ59SUBq-yTL6YNvPtXMevYJAXYvRkM6969KveHjgDOifwQmi65T33_a0m00" alt="uml diagram"> <figcaption>Exemplo2 Factory Method.</figcaption></figure>
A classe `Figure` fornece um método de fábrica `createManipulator` que permite aos clientes criar o correspondente `Manipulator` de uma `Figure`. As subclasses de `Figure` substituem esse método para retornar uma instância da subclasse `Manipulator` correta para elas. Como alternativa, a classe `Figure` pode implementar `createManipulator` para retornar por omissão uma instância de manipulator, e as subclasses de `Figure` podem simplesmente herdar essa instância por omissão. As classes `Figure` que fizerem assim não necessitarão de uma subclasse correspondente de `Manipulator` — por isso dizemos que as hierarquias são somente parcialmente paralelas. Note como o método de fábrica define a conexão entre as duas hierarquias de classes. Nele se localiza o conhecimento de quais classes trabalham juntas.
<h2 id="implementacao"><a href="#implementacao" class="header-anchor">#</a> Implementação</h2> <p>Considere os seguintes tópicos ao aplicar o padrão Factory Method:</p> <ol><li>Duas variedades principais. As duas principais variações do padrão Factory Method são: (1) o caso em que a classe <code>Creator</code> é uma classe abstrata e não fornece uma implementação para o método de fábrica que ela declara, e (2) o caso quando o <code>Creator</code> é uma classe concreta e fornece uma implementação por omissão para o método de fábrica. Também é possível ter uma classe abstrata que define uma implementação por omissão, mas isto é menos comum. O primeiro caso exige subclasses para definir uma implementação porque não existe uma omissão razoável, assim contornando o dilema de ter que instanciar classes imprevisíveis. No segundo caso, o <code>ConcretCreator</code> usa o método de fábrica principalmente por razões de flexibilidade. Está seguindo uma regra que diz: &quot;criar objetos numa operação separada de modo que subclasses possam redefinir a maneira como eles são criados&quot;. Essa regra garante que projetistas de subclasses, caso necessário, possam mudar a classe de objetos que a classe ancestral instancia.</li> <li>Métodos de fábrica parametrizados. Uma outra variante do padrão permite ao método de fábrica criar múltiplos tipos de produtos. O método de fábrica recebe um parâmetro que identifica o objeto a ser criado.</li></ol> <p>Todos os objetos que o método de fábrica cria compartilharão a interface de <code>Product</code>. No exemplo de <code>Document</code>, <code>Application</code> pode suportar diferentes tipos de Documents. Você passa a <code>createDocument</code> um parâmetro extra para especificar o tipo de documento a ser criado.</p> <p>O framework de edição gráfica Unidraw [VL90] usa esta abordagem para reconstruir objetos salvos em disco. Unidraw define uma classe creator com método de fábrica <code>Create</code> que aceita um identificador de classe como argumento. O identificador de classe especifica a classe a ser instanciada. Quando Unidraw salva um objeto em disco, primeiro grava o identificador da classe, e então suas variáveis de instância. Quando reconstrói o objeto de disco, primeiro lê o identificador de classe.</p> <p>Depois que o identificador de classe é lido, o framework chama <code>Create</code>, passando o identificador como o parâmetro. <code>Create</code> procura o constructor para a classe correspondente, utilizando-o para instanciar o objeto. Por último, <code>Create</code> chama a operação <code>read</code> do objeto, a qual lê a informação restante do disco e inicia as variáveis de instância do objeto.</p> <p>Um método de fábrica parametrizado tem a seguinte forma geral, onde <code>MyProduct</code> e <code>YourProduct</code> São subclasses de <code>Product</code>:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Creator</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">Product</span> <span class="token function">create</span><span class="token punctuation">(</span> <span class="token class-name">ProductId</span> id<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">==</span> MINE<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MyProduct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">==</span> YOURS<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">YourProduct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// repete para os produtos restantes</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>Redefinir um método de fábrica parametrizado permite, fácil e seletivamente, estender ou mudar os produtos que um <code>Creator</code> produz. Você pode introduzir novos identificadores para novos tipos de produtos, ou pode associar identificadores existentes com diferentes produtos.</p> <p>Por exemplo, uma subclasse <code>MyCreator</code> poderia trocar <code>MyProduct</code> por <code>YourProduct</code> e suportar uma nova subclasse <code>TheirProduct</code>:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">MyCreator</span> <span class="token keyword">extends</span> <span class="token class-name">Creator</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">Product</span> <span class="token function">create</span><span class="token punctuation">(</span> <span class="token class-name">ProductId</span> id<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">==</span> YOURS<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MyProduct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">==</span> MINE<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">YourProduct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// nota: YOURS e MINE foram trocados propositadamente</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">==</span> THEIR<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">TheirProduct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>Note que a última coisa que essa operação faz é chamar <code>create</code> na classe-mãe. Isso porque <code>MyCreator.create</code> trata somente YOURS, MINE e THEIRS de modo diferente da classe-mãe.</p> <p>Ela não está interessada em outras classes. Daí dizermos que <code>MyCreator</code> estende os tipos de produtos criados e adia a responsabilidade da criação de todos, exceto uns poucos produtos, para sua superclasse.</p> <h2 id="exemplo-de-codigo"><a href="#exemplo-de-codigo" class="header-anchor">#</a> Exemplo de código</h2> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MazeGame</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">Maze</span> <span class="token function">createMaze</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Maze</span> aMaze <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Maze</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Room</span> r1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Room</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span> <span class="token punctuation">;</span>
        <span class="token class-name">Room</span> r2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Room</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
        <span class="token class-name">Door</span> theDoor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Door</span><span class="token punctuation">(</span>r1<span class="token punctuation">,</span>r2<span class="token punctuation">)</span><span class="token punctuation">;</span>

        aMaze<span class="token punctuation">.</span><span class="token function">addRoom</span><span class="token punctuation">(</span>r1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        aMaze<span class="token punctuation">.</span><span class="token function">addRoom</span><span class="token punctuation">(</span>r2<span class="token punctuation">)</span><span class="token punctuation">;</span>

        r1<span class="token punctuation">.</span><span class="token function">setSide</span><span class="token punctuation">(</span>NORTH<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Wall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        r1<span class="token punctuation">.</span><span class="token function">setSide</span><span class="token punctuation">(</span>EAST<span class="token punctuation">,</span> theDoor<span class="token punctuation">)</span><span class="token punctuation">;</span>
        r1<span class="token punctuation">.</span><span class="token function">setSide</span><span class="token punctuation">(</span>SOUTH<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Wall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        r1<span class="token punctuation">.</span><span class="token function">setSide</span><span class="token punctuation">(</span>WEST<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Wall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        r2<span class="token punctuation">.</span><span class="token function">setSide</span><span class="token punctuation">(</span>NORTH<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Wall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        r2<span class="token punctuation">.</span><span class="token function">setSide</span><span class="token punctuation">(</span>SOUTH<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Wall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        r2<span class="token punctuation">.</span><span class="token function">setSide</span><span class="token punctuation">(</span>EAST<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Wall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        r2<span class="token punctuation">.</span><span class="token function">setSide</span><span class="token punctuation">(</span>WEST<span class="token punctuation">,</span> theDoor<span class="token punctuation">)</span> <span class="token punctuation">;</span>
        
        <span class="token keyword">return</span> aMaze<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>A função <code>createMaze</code> constrói e retorna um labirinto. Um problema com esta função é que codifica de maneira rígida as classes de labirinto, salas, portas e paredes. Nós introduziremos o Factory Method para permitir às subclasses escolherem estes componentes.</p> <p>Primeiramente, definiremos o Factory Method em <code>MazeGame</code> para criar os objetos-labirinto, sala, parede e porta:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MazeGame</span> <span class="token punctuation">{</span>
    <span class="token comment">//...</span>
    <span class="token comment">// métodos—fábrica</span>
    <span class="token keyword">public</span> <span class="token class-name">MazeGame</span> <span class="token function">makeMaze</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Maze</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token class-name">Room</span> <span class="token function">makeRoom</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Room</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token class-name">Wall</span> <span class="token function">makeWall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Wall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token class-name">Door</span> makeDoor <span class="token punctuation">(</span><span class="token class-name">Room</span> r1<span class="token punctuation">,</span> <span class="token class-name">Room</span> r2<span class="token punctuation">)</span><span class="token punctuation">{</span> 
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Door</span> <span class="token punctuation">(</span>r1<span class="token punctuation">,</span> r2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>Cada Factory Method retorna um componente de labirinto de um certo tipo. <code>MazeGame</code> fornece implementações por omissão que retornam os tipos mais simples de labirinto, salas, portas e paredes.</p> <p>Agora podemos reescrever <code>createMaze</code> para usar esses métodos fábrica:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MazeGame</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">Maze</span> <span class="token function">createMaze</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Maze</span> aMaze <span class="token operator">=</span> <span class="token function">makeMaze</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Room</span> r1 <span class="token operator">=</span> <span class="token function">makeRoom</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span> <span class="token punctuation">;</span>
        <span class="token class-name">Room</span> r2 <span class="token operator">=</span> <span class="token function">makeRoom</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
        <span class="token class-name">Door</span> theDoor <span class="token operator">=</span> <span class="token function">makeDoor</span><span class="token punctuation">(</span>r1<span class="token punctuation">,</span>r2<span class="token punctuation">)</span><span class="token punctuation">;</span>

        aMaze<span class="token punctuation">.</span><span class="token function">addRoom</span><span class="token punctuation">(</span>r1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        aMaze<span class="token punctuation">.</span><span class="token function">addRoom</span><span class="token punctuation">(</span>r2<span class="token punctuation">)</span><span class="token punctuation">;</span>

        r1<span class="token punctuation">.</span><span class="token function">setSide</span><span class="token punctuation">(</span>NORTH<span class="token punctuation">,</span> <span class="token function">makeWall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        r1<span class="token punctuation">.</span><span class="token function">setSide</span><span class="token punctuation">(</span>EAST<span class="token punctuation">,</span> theDoor<span class="token punctuation">)</span><span class="token punctuation">;</span>
        r1<span class="token punctuation">.</span><span class="token function">setSide</span><span class="token punctuation">(</span>SOUTH<span class="token punctuation">,</span> <span class="token function">makeWall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        r1<span class="token punctuation">.</span><span class="token function">setSide</span><span class="token punctuation">(</span>WEST<span class="token punctuation">,</span> <span class="token function">makeWall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        r2<span class="token punctuation">.</span><span class="token function">setSide</span><span class="token punctuation">(</span>NORTH<span class="token punctuation">,</span> <span class="token function">makeWall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        r2<span class="token punctuation">.</span><span class="token function">setSide</span><span class="token punctuation">(</span>SOUTH<span class="token punctuation">,</span> <span class="token function">makeWall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        r2<span class="token punctuation">.</span><span class="token function">setSide</span><span class="token punctuation">(</span>EAST<span class="token punctuation">,</span> <span class="token function">makeWall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        r2<span class="token punctuation">.</span><span class="token function">setSide</span><span class="token punctuation">(</span>WEST<span class="token punctuation">,</span> theDoor<span class="token punctuation">)</span> <span class="token punctuation">;</span>
        
        <span class="token keyword">return</span> aMaze<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>Diferentes jogos podem introduzir subclasses de <code>MazeGame</code> para especializar partes do labirinto. As subclasses de <code>MazeGame</code> podem redefinir alguns ou todos os Factory Methods para especificar variações em produtos. Por exemplo, um <code>BombedMazeGame</code> pode redefinir os produtos <code>Room</code> e para retornar variedades com bombas:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BombedMazeGame</span> <span class="token keyword">extends</span> <span class="token class-name">MazeGame</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">Wall</span> <span class="token function">makeWall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">BombedWall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token class-name">Room</span> <span class="token function">makeRoom</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RoomWithABomb</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="usos-conhecidos"><a href="#usos-conhecidos" class="header-anchor">#</a> Usos conhecidos</h2> <p>Os Factory Methods permeiam toolkits e frameworks. O exemplo precedente de documentos é um uso típico no MacApp e ET++ [WGM88]. O exemplo do manipulador vem do Unidraw.</p> <p>A classe View no frameworks Model/View/Controller/Smalltalk-80 tem um método defaultController que cria um controlador, e isso pode parecer ser o Factory Method [Par90]. Mas subclasses de View especificam a classe no seu controlador por omissão através da definição de defaultControllerClass, que retorna a classe da qual defaultController cria instâncias. Assim, defaultControllerClass é o verdadeiro método fábrica, isto é, o método que as subclasses deveriam redefinir.</p> <p>Um exemplo mais esotérico no Smalltalk-80 é o Factory Method parserClass definido por Behavior (uma superclasse de todos os objetos que representam classes). Isto permite a uma classe usar um parser (analisador) customizado para seu código-fonte. Por exemplo, um cliente pode definir uma classe SQLParser para analisar o código-fonte de uma classe com comandos SQL embutidos. A Classe Behavior implementa parserClass retornando a classe Parser padrão do Smalltalk. A classe que inclui comandos SQL embutidos redefine este método (como um método de classe) e retorna a classe SQLParser.</p> <p>O sistema ORB Orbix da IONA Technologies [ION94] usa Factory Method para gerar um tipo apropriado de <a href="/vuepressppr/gof/Criacao/FactoryMethod/Proxy.html">proxy</a> quando um objeto solicita uma referência para um Objeto remoto. O Factory Method torna fácil substituir o proxy-padrão por um outro que, por exemplo, use caching do lado do cliente.</p> <h2 id="padrao-relacionados"><a href="#padrao-relacionados" class="header-anchor">#</a> Padrão relacionados</h2> <p><a href="/vuepressppr/gof/Criacao/FactoryMethod/AbstractFactory.html">Abstract Factory</a> é freqüentemente implementado utilizado o padrão Factory Method. O exemplo na relação de Motivação no padrão Abstract Factory também ilustra o padrão Factory Method.</p> <p>Factory Methods são usualmente chamados dentro de <a href="/vuepressppr/gof/Criacao/FactoryMethod/TemplateMethod.html">Template Methods</a>. No exemplo do documento acima, NewDocument é um template method.</p> <p><a href="/vuepressppr/gof/Criacao/FactoryMethod/Prototype.html">Prototypes</a> não exigem subclassificação de Creator. Contudo, freqüentemente necessitam uma operação Initialize na classe Product. A Creator usa Initialize para iniciar o objeto. O Factory Method não exige uma operação desse tipo.</p> <h2 id="referencias"><a href="#referencias" class="header-anchor">#</a> Referências</h2> <hr class="footnotes-sep"> <section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p>GAMMA, Erich. et al. Padrões de projetos: Soluções reutilizáveis de software orientados a objetos Bookman editora, 2009. <a href="#fnref1" class="footnote-backref">↩︎</a></p></li></ol></section></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/leandro-costa/vuepressppr/edit/master/src/gof/Criacao/FactoryMethod/README.md" target="_blank" rel="noopener noreferrer">Edit!</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">3/23/2022, 11:26:47 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vuepressppr/gof/Criacao/" class="prev router-link-active">
        Discussão sobre padrões de criação
      </a></span> <!----></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/vuepressppr/assets/js/app.5f32d716.js" defer></script><script src="/vuepressppr/assets/js/2.63c38da0.js" defer></script><script src="/vuepressppr/assets/js/22.590de762.js" defer></script><script src="/vuepressppr/assets/js/3.5bc5870a.js" defer></script>
  </body>
</html>
